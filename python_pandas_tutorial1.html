<!DOCTYPE html>
<html lang="cn">
<head>
        <meta charset="utf-8" />
        <title>pandas入门</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">python自动化测试人工智能 </a></h1>
                <nav><ul>
                    <li><a href="/category/ce-shi.html">测试</a></li>
                    <li><a href="/category/ce-shi-kuang-jia.html">测试框架</a></li>
                    <li><a href="/category/common.html">common</a></li>
                    <li><a href="/category/ji-qi-xue-xi.html">机器学习</a></li>
                    <li><a href="/category/linux.html">linux</a></li>
                    <li><a href="/category/python.html">python</a></li>
                    <li class="active"><a href="/category/shu-ju-fen-xi.html">数据分析</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/python_pandas_tutorial1.html" rel="bookmark"
           title="Permalink to pandas入门">pandas入门</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-03-31T17:20:00+08:00">
                Published: 六 31 三月 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/andrew.html">andrew</a>
        </address>
<p>In <a href="/category/shu-ju-fen-xi.html">数据分析</a>.</p>

</footer><!-- /.post-info -->      <h2 id="pandas">pandas入门</h2>
<h3 id="_1">简介</h3>
<p>pandas包含的数据结构和操作工具能快速简单地清洗和分析数据。</p>
<p>pandas经常与NumPy和SciPy这样的数据计算工具，statsmodels和scikit-learn之类的分析库及数据可视化库（如matplotlib）等一起用使用。pandas基于NumPy的数组，经常可以不使用循环就能处理好大量数据。</p>
<p>pandas适合处理表格数据或巨量数据。NumPy则适合处理巨量的数值数组数据。</p>
<p>这里约定导入方式：</p>
<p>技术支持qq群：630011153</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
</pre></div>
</td></tr></table>

<h3 id="pandas_1">pandas数据结构介绍</h3>
<ul>
<li>
<p>技术支持 钉钉群：21745728(可以加钉钉pythontesting邀请加入) qq群：144081101 591302926  567351477</p>
</li>
<li>
<p>道家技术-手相手诊看相中医等钉钉群21734177 qq群：391441566 184175668 338228106 看手相、面相、舌相、抽签、体质识别。服务费50元每人次起。请联系钉钉或者微信pythontesting</p>
</li>
</ul>
<p><a href="https://china-testing.github.io/testing_training.html">接口自动化性能测试数据分析人工智能从业专家一对一线上培训大纲</a></p>
<p>主要数据结构:Series和DataFrame。</p>
<h4 id="series">Series</h4>
<p>Series类似于一维数组的对象,它由一组数据(NumPy类似数据类型)以及相关的数据标签(即索引)组成。仅由一组数据即可产生最简单的Series:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">obj</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="mi">4</span>
<span class="mi">1</span>    <span class="mi">7</span>
<span class="mi">2</span>   <span class="o">-</span><span class="mi">5</span>
<span class="mi">3</span>    <span class="mi">3</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">obj</span><span class="o">.</span><span class="n">values</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">obj</span><span class="o">.</span><span class="n">index</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">Int64Index</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>指定索引:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">obj2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">obj2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> 
<span class="n">d</span>    <span class="mi">4</span>
<span class="n">b</span>    <span class="mi">7</span>
<span class="n">a</span>   <span class="o">-</span><span class="mi">5</span>
<span class="n">c</span>    <span class="mi">3</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">obj2</span><span class="o">.</span><span class="n">index</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">Index</span><span class="p">([</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">obj2</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="o">-</span><span class="mi">5</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">obj2</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="n">obj2</span><span class="p">[[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> 
<span class="n">c</span>    <span class="mi">3</span>
<span class="n">a</span>   <span class="o">-</span><span class="mi">5</span>
<span class="n">d</span>    <span class="mi">6</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</td></tr></table>

<p>可见与普通NumPy数组相比,你还可以通过索引的方式选取Series中的值。</p>
<p>NumPy函数或类似操作，如根据布尔型数组进行过滤、标量乘法、应用数学函数等)都会保留索引和值之间的链接:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">obj2</span><span class="p">[</span><span class="n">obj2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> 
<span class="n">d</span>    <span class="mi">6</span>
<span class="n">b</span>    <span class="mi">7</span>
<span class="n">c</span>    <span class="mi">3</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">obj2</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> 
<span class="n">d</span>    <span class="mi">12</span>
<span class="n">b</span>    <span class="mi">14</span>
<span class="n">a</span>   <span class="o">-</span><span class="mi">10</span>
<span class="n">c</span>     <span class="mi">6</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">obj2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> 
<span class="n">d</span>    <span class="mi">6</span>
<span class="n">b</span>    <span class="mi">7</span>
<span class="n">a</span>   <span class="o">-</span><span class="mi">5</span>
<span class="n">c</span>    <span class="mi">3</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">obj2</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> 
<span class="n">d</span>     <span class="mf">403.428793</span>
<span class="n">b</span>    <span class="mf">1096.633158</span>
<span class="n">a</span>       <span class="mf">0.006738</span>
<span class="n">c</span>      <span class="mf">20.085537</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="s1">&#39;b&#39;</span> <span class="ow">in</span> <span class="n">obj2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="bp">True</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="s1">&#39;e&#39;</span> <span class="ow">in</span> <span class="n">obj2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="bp">False</span>
</pre></div>
</td></tr></table>

<p>可见可以吧Series看成是定长的有序字典。也可由字典创建Series:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="n">sdata</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Ohio&#39;</span><span class="p">:</span> <span class="mi">35000</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">:</span> <span class="mi">71000</span><span class="p">,</span> <span class="s1">&#39;Oregon&#39;</span><span class="p">:</span> <span class="mi">16000</span><span class="p">,</span> <span class="s1">&#39;Utah&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="n">obj3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">sdata</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">23</span><span class="p">]:</span> <span class="n">obj3</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">23</span><span class="p">]:</span> 
<span class="n">Ohio</span>      <span class="mi">35000</span>
<span class="n">Oregon</span>    <span class="mi">16000</span>
<span class="n">Texas</span>     <span class="mi">71000</span>
<span class="n">Utah</span>       <span class="mi">5000</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">24</span><span class="p">]:</span> <span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;California&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Oregon&#39;</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">25</span><span class="p">]:</span> <span class="n">obj4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">sdata</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">states</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">26</span><span class="p">]:</span> <span class="n">obj4</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">26</span><span class="p">]:</span> 
<span class="n">California</span>        <span class="n">NaN</span>
<span class="n">Ohio</span>          <span class="mf">35000.0</span>
<span class="n">Oregon</span>        <span class="mf">16000.0</span>
<span class="n">Texas</span>         <span class="mf">71000.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">27</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">obj4</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">27</span><span class="p">]:</span> 
<span class="n">California</span>     <span class="bp">True</span>
<span class="n">Ohio</span>          <span class="bp">False</span>
<span class="n">Oregon</span>        <span class="bp">False</span>
<span class="n">Texas</span>         <span class="bp">False</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">28</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">notnull</span><span class="p">(</span><span class="n">obj4</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">28</span><span class="p">]:</span> 
<span class="n">California</span>    <span class="bp">False</span>
<span class="n">Ohio</span>           <span class="bp">True</span>
<span class="n">Oregon</span>         <span class="bp">True</span>
<span class="n">Texas</span>          <span class="bp">True</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">29</span><span class="p">]:</span> <span class="n">obj4</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">29</span><span class="p">]:</span> 
<span class="n">California</span>     <span class="bp">True</span>
<span class="n">Ohio</span>          <span class="bp">False</span>
<span class="n">Oregon</span>        <span class="bp">False</span>
<span class="n">Texas</span>         <span class="bp">False</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">32</span><span class="p">]:</span> <span class="n">obj4</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">32</span><span class="p">]:</span> 
<span class="n">California</span>    <span class="bp">False</span>
<span class="n">Ohio</span>           <span class="bp">True</span>
<span class="n">Oregon</span>         <span class="bp">True</span>
<span class="n">Texas</span>          <span class="bp">True</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>
</pre></div>
</td></tr></table>

<p>相加</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">33</span><span class="p">]:</span> <span class="n">obj3</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">33</span><span class="p">]:</span> 
<span class="n">Ohio</span>      <span class="mi">35000</span>
<span class="n">Oregon</span>    <span class="mi">16000</span>
<span class="n">Texas</span>     <span class="mi">71000</span>
<span class="n">Utah</span>       <span class="mi">5000</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">34</span><span class="p">]:</span> <span class="n">obj4</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">34</span><span class="p">]:</span> 
<span class="n">California</span>        <span class="n">NaN</span>
<span class="n">Ohio</span>          <span class="mf">35000.0</span>
<span class="n">Oregon</span>        <span class="mf">16000.0</span>
<span class="n">Texas</span>         <span class="mf">71000.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">35</span><span class="p">]:</span> <span class="n">obj3</span> <span class="o">+</span> <span class="n">obj4</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">35</span><span class="p">]:</span> 
<span class="n">California</span>         <span class="n">NaN</span>
<span class="n">Ohio</span>           <span class="mf">70000.0</span>
<span class="n">Oregon</span>         <span class="mf">32000.0</span>
<span class="n">Texas</span>         <span class="mf">142000.0</span>
<span class="n">Utah</span>               <span class="n">NaN</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">36</span><span class="p">]:</span> <span class="n">obj4</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;population&#39;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">37</span><span class="p">]:</span> <span class="n">obj4</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;state&#39;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">38</span><span class="p">]:</span> <span class="n">obj4</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">38</span><span class="p">]:</span> 
<span class="n">state</span>
<span class="n">California</span>        <span class="n">NaN</span>
<span class="n">Ohio</span>          <span class="mf">35000.0</span>
<span class="n">Oregon</span>        <span class="mf">16000.0</span>
<span class="n">Texas</span>         <span class="mf">71000.0</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">population</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">40</span><span class="p">]:</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">41</span><span class="p">]:</span> <span class="n">obj</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Steve&#39;</span><span class="p">,</span> <span class="s1">&#39;Jeff&#39;</span><span class="p">,</span> <span class="s1">&#39;Ryan&#39;</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">42</span><span class="p">]:</span> <span class="n">obj</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">42</span><span class="p">]:</span> 
<span class="n">Bob</span>      <span class="mi">4</span>
<span class="n">Steve</span>    <span class="mi">7</span>
<span class="n">Jeff</span>    <span class="o">-</span><span class="mi">5</span>
<span class="n">Ryan</span>     <span class="mi">3</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</td></tr></table>

<p>本文代码地址：https://github.com/china-testing/python-api-tesing/</p>
<p>本文最新版本地址：http://t.cn/R8tJ9JH</p>
<p>交流QQ群：python 测试开发 144081101</p>
<p>wechat： pythontesting</p>
<p>淘宝天猫可以把链接发给qq850766020，为你生成优惠券，降低你的购物成本！</p>
<h4 id="dataframe">DataFrame</h4>
<p>DataFrame是矩状表格型的数据结构，包含有序的列，每列可以是不同的类型(数值、字符串、布尔值等)。DataFrame既有行索引也有列索引，它可以被看做由相同索引的Series组成的字典。DataFrame中的数据是以一个或多个二维块存放的。</p>
<p>构建DataFrame的办法有很多，最常用的是直接传入等长列表或NumPy数组组成的字典。DataFrame会自动加上索引(跟Series一样)，有序排列。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> 

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;state&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Nevada&#39;</span><span class="p">,</span> <span class="s1">&#39;Nevada&#39;</span><span class="p">,</span> <span class="s1">&#39;Nevada&#39;</span><span class="p">],</span>
   <span class="o">...</span><span class="p">:</span> <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2001</span><span class="p">,</span> <span class="mi">2002</span><span class="p">,</span> <span class="mi">2001</span><span class="p">,</span> <span class="mi">2002</span><span class="p">,</span> <span class="mi">2003</span><span class="p">],</span>
   <span class="o">...</span><span class="p">:</span> <span class="s1">&#39;pop&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">]}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> 

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">frame</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> 
   <span class="n">pop</span>   <span class="n">state</span>  <span class="n">year</span>
<span class="mi">0</span>  <span class="mf">1.5</span>    <span class="n">Ohio</span>  <span class="mi">2000</span>
<span class="mi">1</span>  <span class="mf">1.7</span>    <span class="n">Ohio</span>  <span class="mi">2001</span>
<span class="mi">2</span>  <span class="mf">3.6</span>    <span class="n">Ohio</span>  <span class="mi">2002</span>
<span class="mi">3</span>  <span class="mf">2.4</span>  <span class="n">Nevada</span>  <span class="mi">2001</span>
<span class="mi">4</span>  <span class="mf">2.9</span>  <span class="n">Nevada</span>  <span class="mi">2002</span>
<span class="mi">5</span>  <span class="mf">3.2</span>  <span class="n">Nevada</span>  <span class="mi">2003</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">frame</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> 
   <span class="n">pop</span>   <span class="n">state</span>  <span class="n">year</span>
<span class="mi">0</span>  <span class="mf">1.5</span>    <span class="n">Ohio</span>  <span class="mi">2000</span>
<span class="mi">1</span>  <span class="mf">1.7</span>    <span class="n">Ohio</span>  <span class="mi">2001</span>
<span class="mi">2</span>  <span class="mf">3.6</span>    <span class="n">Ohio</span>  <span class="mi">2002</span>
<span class="mi">3</span>  <span class="mf">2.4</span>  <span class="n">Nevada</span>  <span class="mi">2001</span>
<span class="mi">4</span>  <span class="mf">2.9</span>  <span class="n">Nevada</span>  <span class="mi">2002</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> 

<span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;pop&#39;</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span> 
   <span class="n">year</span>   <span class="n">state</span>  <span class="n">pop</span>
<span class="mi">0</span>  <span class="mi">2000</span>    <span class="n">Ohio</span>  <span class="mf">1.5</span>
<span class="mi">1</span>  <span class="mi">2001</span>    <span class="n">Ohio</span>  <span class="mf">1.7</span>
<span class="mi">2</span>  <span class="mi">2002</span>    <span class="n">Ohio</span>  <span class="mf">3.6</span>
<span class="mi">3</span>  <span class="mi">2001</span>  <span class="n">Nevada</span>  <span class="mf">2.4</span>
<span class="mi">4</span>  <span class="mi">2002</span>  <span class="n">Nevada</span>  <span class="mf">2.9</span>
<span class="mi">5</span>  <span class="mi">2003</span>  <span class="n">Nevada</span>  <span class="mf">3.2</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="n">frame2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;pop&#39;</span><span class="p">,</span> <span class="s1">&#39;debt&#39;</span><span class="p">],</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;four&#39;</span><span class="p">,</span> <span class="s1">&#39;five&#39;</span><span class="p">,</span> <span class="s1">&#39;six&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">frame2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span> 
       <span class="n">year</span>   <span class="n">state</span>  <span class="n">pop</span> <span class="n">debt</span>
<span class="n">one</span>    <span class="mi">2000</span>    <span class="n">Ohio</span>  <span class="mf">1.5</span>  <span class="n">NaN</span>
<span class="n">two</span>    <span class="mi">2001</span>    <span class="n">Ohio</span>  <span class="mf">1.7</span>  <span class="n">NaN</span>
<span class="n">three</span>  <span class="mi">2002</span>    <span class="n">Ohio</span>  <span class="mf">3.6</span>  <span class="n">NaN</span>
<span class="n">four</span>   <span class="mi">2001</span>  <span class="n">Nevada</span>  <span class="mf">2.4</span>  <span class="n">NaN</span>
<span class="n">five</span>   <span class="mi">2002</span>  <span class="n">Nevada</span>  <span class="mf">2.9</span>  <span class="n">NaN</span>
<span class="n">six</span>    <span class="mi">2003</span>  <span class="n">Nevada</span>  <span class="mf">3.2</span>  <span class="n">NaN</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">frame2</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> 
<span class="n">one</span>        <span class="n">Ohio</span>
<span class="n">two</span>        <span class="n">Ohio</span>
<span class="n">three</span>      <span class="n">Ohio</span>
<span class="n">four</span>     <span class="n">Nevada</span>
<span class="n">five</span>     <span class="n">Nevada</span>
<span class="n">six</span>      <span class="n">Nevada</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">state</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</td></tr></table>

<p>可见还可以通过columns指定DataFrame的列序, index指定索引名。跟Series一样，如果传入的列在数据中找不到，就会产生NaN值。通过类似字典的方式或属性的方式，可以将DataFrame的列获取为Series，返回的Series拥有DataFrame相同的索引，且其name属性也已经被相应地设置好。</p>
<p>行也可以用loc属性通过位置或名称的方式进行获取。列可以通过赋值的方式进行修改。
将列表或数组赋值给某个列时，其长度必须跟DataFrame的长度相匹配。如果赋值的是Series，就会精确匹配</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">frame2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;three&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> 
<span class="n">year</span>     <span class="mi">2002</span>
<span class="n">state</span>    <span class="n">Ohio</span>
<span class="n">pop</span>       <span class="mf">3.6</span>
<span class="n">debt</span>      <span class="n">NaN</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">three</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="n">frame2</span><span class="p">[</span><span class="s1">&#39;debt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">16.5</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">frame2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> 
       <span class="n">year</span>   <span class="n">state</span>  <span class="n">pop</span>  <span class="n">debt</span>
<span class="n">one</span>    <span class="mi">2000</span>    <span class="n">Ohio</span>  <span class="mf">1.5</span>  <span class="mf">16.5</span>
<span class="n">two</span>    <span class="mi">2001</span>    <span class="n">Ohio</span>  <span class="mf">1.7</span>  <span class="mf">16.5</span>
<span class="n">three</span>  <span class="mi">2002</span>    <span class="n">Ohio</span>  <span class="mf">3.6</span>  <span class="mf">16.5</span>
<span class="n">four</span>   <span class="mi">2001</span>  <span class="n">Nevada</span>  <span class="mf">2.4</span>  <span class="mf">16.5</span>
<span class="n">five</span>   <span class="mi">2002</span>  <span class="n">Nevada</span>  <span class="mf">2.9</span>  <span class="mf">16.5</span>
<span class="n">six</span>    <span class="mi">2003</span>  <span class="n">Nevada</span>  <span class="mf">3.2</span>  <span class="mf">16.5</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">frame2</span><span class="p">[</span><span class="s1">&#39;debt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">6.</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">frame2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> 
       <span class="n">year</span>   <span class="n">state</span>  <span class="n">pop</span>  <span class="n">debt</span>
<span class="n">one</span>    <span class="mi">2000</span>    <span class="n">Ohio</span>  <span class="mf">1.5</span>   <span class="mf">0.0</span>
<span class="n">two</span>    <span class="mi">2001</span>    <span class="n">Ohio</span>  <span class="mf">1.7</span>   <span class="mf">1.0</span>
<span class="n">three</span>  <span class="mi">2002</span>    <span class="n">Ohio</span>  <span class="mf">3.6</span>   <span class="mf">2.0</span>
<span class="n">four</span>   <span class="mi">2001</span>  <span class="n">Nevada</span>  <span class="mf">2.4</span>   <span class="mf">3.0</span>
<span class="n">five</span>   <span class="mi">2002</span>  <span class="n">Nevada</span>  <span class="mf">2.9</span>   <span class="mf">4.0</span>
<span class="n">six</span>    <span class="mi">2003</span>  <span class="n">Nevada</span>  <span class="mf">3.2</span>   <span class="mf">5.0</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">val</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.7</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;four&#39;</span><span class="p">,</span> <span class="s1">&#39;five&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">frame2</span><span class="p">[</span><span class="s1">&#39;debt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">frame2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> 
       <span class="n">year</span>   <span class="n">state</span>  <span class="n">pop</span>  <span class="n">debt</span>
<span class="n">one</span>    <span class="mi">2000</span>    <span class="n">Ohio</span>  <span class="mf">1.5</span>   <span class="n">NaN</span>
<span class="n">two</span>    <span class="mi">2001</span>    <span class="n">Ohio</span>  <span class="mf">1.7</span>  <span class="o">-</span><span class="mf">1.2</span>
<span class="n">three</span>  <span class="mi">2002</span>    <span class="n">Ohio</span>  <span class="mf">3.6</span>   <span class="n">NaN</span>
<span class="n">four</span>   <span class="mi">2001</span>  <span class="n">Nevada</span>  <span class="mf">2.4</span>  <span class="o">-</span><span class="mf">1.5</span>
<span class="n">five</span>   <span class="mi">2002</span>  <span class="n">Nevada</span>  <span class="mf">2.9</span>  <span class="o">-</span><span class="mf">1.7</span>
<span class="n">six</span>    <span class="mi">2003</span>  <span class="n">Nevada</span>  <span class="mf">3.2</span>   <span class="n">NaN</span>
</pre></div>
</td></tr></table>

<p>为不存在的列赋值会创建出一个新列。关键字del用于删除列：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="n">frame2</span><span class="p">[</span><span class="s1">&#39;eastern&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame2</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Ohio&#39;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="n">frame2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">20</span><span class="p">]:</span> 
       <span class="n">year</span>   <span class="n">state</span>  <span class="n">pop</span>  <span class="n">debt</span>  <span class="n">eastern</span>
<span class="n">one</span>    <span class="mi">2000</span>    <span class="n">Ohio</span>  <span class="mf">1.5</span>   <span class="n">NaN</span>     <span class="bp">True</span>
<span class="n">two</span>    <span class="mi">2001</span>    <span class="n">Ohio</span>  <span class="mf">1.7</span>  <span class="o">-</span><span class="mf">1.2</span>     <span class="bp">True</span>
<span class="n">three</span>  <span class="mi">2002</span>    <span class="n">Ohio</span>  <span class="mf">3.6</span>   <span class="n">NaN</span>     <span class="bp">True</span>
<span class="n">four</span>   <span class="mi">2001</span>  <span class="n">Nevada</span>  <span class="mf">2.4</span>  <span class="o">-</span><span class="mf">1.5</span>    <span class="bp">False</span>
<span class="n">five</span>   <span class="mi">2002</span>  <span class="n">Nevada</span>  <span class="mf">2.9</span>  <span class="o">-</span><span class="mf">1.7</span>    <span class="bp">False</span>
<span class="n">six</span>    <span class="mi">2003</span>  <span class="n">Nevada</span>  <span class="mf">3.2</span>   <span class="n">NaN</span>    <span class="bp">False</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="k">del</span> <span class="n">frame2</span><span class="p">[</span><span class="s1">&#39;eastern&#39;</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="n">frame2</span><span class="o">.</span><span class="n">columns</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="n">Index</span><span class="p">([</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;pop&#39;</span><span class="p">,</span> <span class="s1">&#39;debt&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>通过索引方式返回的列只是相应数据的视图而不是副本。因此，对返回的Series所做的任何就地修改
全都会反映到源DataFrame上。通过Series的copy方法即可显式地复制列。</p>
<p>另一种常见的数据形式是嵌套字典，外层字典的键作为列，内层键则作为行索引：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">23</span><span class="p">]:</span> <span class="n">pop</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Nevada&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">2001</span><span class="p">:</span> <span class="mf">2.4</span><span class="p">,</span> <span class="mi">2002</span><span class="p">:</span> <span class="mf">2.9</span><span class="p">},</span>
   <span class="o">....</span><span class="p">:</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">2000</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2001</span><span class="p">:</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mi">2002</span><span class="p">:</span> <span class="mf">3.6</span><span class="p">}}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">24</span><span class="p">]:</span> <span class="n">frame3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pop</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">25</span><span class="p">]:</span> <span class="n">frame3</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">25</span><span class="p">]:</span> 
      <span class="n">Nevada</span>  <span class="n">Ohio</span>
<span class="mi">2000</span>     <span class="n">NaN</span>   <span class="mf">1.5</span>
<span class="mi">2001</span>     <span class="mf">2.4</span>   <span class="mf">1.7</span>
<span class="mi">2002</span>     <span class="mf">2.9</span>   <span class="mf">3.6</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">26</span><span class="p">]:</span> <span class="n">frame3</span><span class="o">.</span><span class="n">T</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">26</span><span class="p">]:</span> 
        <span class="mi">2000</span>  <span class="mi">2001</span>  <span class="mi">2002</span>
<span class="n">Nevada</span>   <span class="n">NaN</span>   <span class="mf">2.4</span>   <span class="mf">2.9</span>
<span class="n">Ohio</span>     <span class="mf">1.5</span>   <span class="mf">1.7</span>   <span class="mf">3.6</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">27</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">2002</span><span class="p">,</span> <span class="mi">2003</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">27</span><span class="p">]:</span> 
      <span class="n">Nevada</span>  <span class="n">Ohio</span>
<span class="mi">2001</span>     <span class="mf">2.4</span>   <span class="mf">1.7</span>
<span class="mi">2002</span>     <span class="mf">2.9</span>   <span class="mf">3.6</span>
<span class="mi">2003</span>     <span class="n">NaN</span>   <span class="n">NaN</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">28</span><span class="p">]:</span> <span class="n">pdata</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Ohio&#39;</span><span class="p">:</span> <span class="n">frame3</span><span class="p">[</span><span class="s1">&#39;Ohio&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Nevada&#39;</span><span class="p">:</span> <span class="n">frame3</span><span class="p">[</span><span class="s1">&#39;Nevada&#39;</span><span class="p">][:</span><span class="mi">2</span><span class="p">]}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">29</span><span class="p">]:</span> <span class="n">pdata</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">29</span><span class="p">]:</span> 
<span class="p">{</span><span class="s1">&#39;Ohio&#39;</span><span class="p">:</span> <span class="mi">2000</span>    <span class="mf">1.5</span>
 <span class="mi">2001</span>    <span class="mf">1.7</span>
 <span class="n">Name</span><span class="p">:</span> <span class="n">Ohio</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span><span class="p">,</span> <span class="s1">&#39;Nevada&#39;</span><span class="p">:</span> <span class="mi">2000</span>    <span class="n">NaN</span>
 <span class="mi">2001</span>    <span class="mf">2.4</span>
 <span class="n">Name</span><span class="p">:</span> <span class="n">Nevada</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span><span class="p">}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">30</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pdata</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">30</span><span class="p">]:</span> 
      <span class="n">Nevada</span>  <span class="n">Ohio</span>
<span class="mi">2000</span>     <span class="n">NaN</span>   <span class="mf">1.5</span>
<span class="mi">2001</span>     <span class="mf">2.4</span>   <span class="mf">1.7</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">31</span><span class="p">]:</span> <span class="n">frame3</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;year&#39;</span><span class="p">;</span> <span class="n">frame3</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;state&#39;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">32</span><span class="p">]:</span> <span class="n">frame3</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">32</span><span class="p">]:</span> 
<span class="n">state</span>  <span class="n">Nevada</span>  <span class="n">Ohio</span>
<span class="n">year</span>               
<span class="mi">2000</span>      <span class="n">NaN</span>   <span class="mf">1.5</span>
<span class="mi">2001</span>      <span class="mf">2.4</span>   <span class="mf">1.7</span>
<span class="mi">2002</span>      <span class="mf">2.9</span>   <span class="mf">3.6</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">33</span><span class="p">]:</span> <span class="n">frame3</span><span class="o">.</span><span class="n">values</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">33</span><span class="p">]:</span> 
<span class="n">array</span><span class="p">([[</span> <span class="n">nan</span><span class="p">,</span>  <span class="mf">1.5</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.4</span><span class="p">,</span>  <span class="mf">1.7</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.9</span><span class="p">,</span>  <span class="mf">3.6</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">34</span><span class="p">]:</span> <span class="n">frame2</span><span class="o">.</span><span class="n">values</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">34</span><span class="p">]:</span> 
<span class="n">array</span><span class="p">([[</span><span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2001</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2002</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2001</span><span class="p">,</span> <span class="s1">&#39;Nevada&#39;</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2002</span><span class="p">,</span> <span class="s1">&#39;Nevada&#39;</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2003</span><span class="p">,</span> <span class="s1">&#39;Nevada&#39;</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="n">nan</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>可见可以转置，由Series组成的字典和字典类似。如果设置了DataFrame的index和columns的name属性,则这些信息也会被显示出来。跟Series一样,values属性也会以二维ndarray的形式返回DataFrame中的数据。如果DataFrame各列的数据类型不同,则值数组的数据类型就会选用能兼容所有列的数据类型。</p>
<p>DataFrame的constructor接受的类型为：2D ndarray、dict of arrays, lists, or tuples、NumPy structured/record、array、dict of Series、dict of dicts、List of dicts or Series、List of lists or tuples、Another DataFrame、NumPy MaskedArray。</p>
<p>更多参考：　https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html</p>
<h4 id="_2">索引对象</h4>
<p>pandas的索引对象负责管理轴标签和其他元数据(比如轴名称等)。构建Series或DataFrame时,所用到的任何数组或其他序列的标签都会被转换成Index。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">35</span><span class="p">]:</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">36</span><span class="p">]:</span> <span class="n">index</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">index</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">37</span><span class="p">]:</span> <span class="n">index</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">37</span><span class="p">]:</span> <span class="n">Index</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">38</span><span class="p">]:</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">38</span><span class="p">]:</span> <span class="n">Index</span><span class="p">([</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">39</span><span class="p">]:</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span>
<span class="o">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">39</span><span class="o">-</span><span class="mi">676</span><span class="n">fdeb26a68</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span>

<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">5</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pandas</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">indexes</span><span class="o">/</span><span class="n">base</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
   <span class="mi">1722</span> 
   <span class="mi">1723</span>     <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="o">-&gt;</span> <span class="mi">1724</span>         <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Index does not support mutable operations&quot;</span><span class="p">)</span>
   <span class="mi">1725</span> 
   <span class="mi">1726</span>     <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>

<span class="ne">TypeError</span><span class="p">:</span> <span class="n">Index</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">support</span> <span class="n">mutable</span> <span class="n">operations</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">40</span><span class="p">]:</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">41</span><span class="p">]:</span> <span class="n">labels</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">41</span><span class="p">]:</span> <span class="n">Int64Index</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">42</span><span class="p">]:</span> <span class="n">obj2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">43</span><span class="p">]:</span> <span class="n">obj2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">43</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="mf">1.5</span>
<span class="mi">1</span>   <span class="o">-</span><span class="mf">2.5</span>
<span class="mi">2</span>    <span class="mf">0.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">44</span><span class="p">]:</span> <span class="n">obj2</span><span class="o">.</span><span class="n">index</span> <span class="ow">is</span> <span class="n">labels</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">44</span><span class="p">]:</span> <span class="bp">True</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">45</span><span class="p">]:</span> <span class="n">frame3</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">45</span><span class="p">]:</span> 
<span class="n">state</span>  <span class="n">Nevada</span>  <span class="n">Ohio</span>
<span class="n">year</span>               
<span class="mi">2000</span>      <span class="n">NaN</span>   <span class="mf">1.5</span>
<span class="mi">2001</span>      <span class="mf">2.4</span>   <span class="mf">1.7</span>
<span class="mi">2002</span>      <span class="mf">2.9</span>   <span class="mf">3.6</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">46</span><span class="p">]:</span> <span class="n">frame3</span><span class="o">.</span><span class="n">columns</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">46</span><span class="p">]:</span> <span class="n">Index</span><span class="p">([</span><span class="s1">&#39;Nevada&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;state&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">47</span><span class="p">]:</span> <span class="s1">&#39;Ohio&#39;</span> <span class="ow">in</span> <span class="n">frame3</span><span class="o">.</span><span class="n">columns</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">47</span><span class="p">]:</span> <span class="bp">True</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">48</span><span class="p">]:</span> <span class="mi">2003</span> <span class="ow">in</span> <span class="n">frame3</span><span class="o">.</span><span class="n">index</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">48</span><span class="p">]:</span> <span class="bp">False</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">49</span><span class="p">]:</span> <span class="n">dup_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">50</span><span class="p">]:</span> <span class="n">dup_labels</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">50</span><span class="p">]:</span> <span class="n">Index</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Index对象是不可变的,因此用户不能对其进行修改，这样Index对象在多个数据结构之间可安全共享。除了像数组,Index类似固定大小的集合。</p>
<p>Index的方法和属性有：append,difference,intersection,union,isin,delete,drop,insert，is_monotonic，unique。</p>
<p>更多参考：　https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Index.html</p>
<h3 id="_3">基本功能</h3>
<p>本节中,我将介绍操作Series和DataFrame中的数据的基本手段。</p>
<h4 id="_4">重新索引</h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">51</span><span class="p">]:</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">7.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.3</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">52</span><span class="p">]:</span> <span class="n">obj</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">52</span><span class="p">]:</span> 
<span class="n">d</span>    <span class="mf">4.5</span>
<span class="n">b</span>    <span class="mf">7.2</span>
<span class="n">a</span>   <span class="o">-</span><span class="mf">5.3</span>
<span class="n">c</span>    <span class="mf">3.6</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="c1"># 调用reindex将会根据新索引进行重排。如果某个索引值当前不存在,就为NaN</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">53</span><span class="p">]:</span> <span class="n">obj2</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">54</span><span class="p">]:</span> <span class="n">obj2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">54</span><span class="p">]:</span> 
<span class="n">a</span>   <span class="o">-</span><span class="mf">5.3</span>
<span class="n">b</span>    <span class="mf">7.2</span>
<span class="n">c</span>    <span class="mf">3.6</span>
<span class="n">d</span>    <span class="mf">4.5</span>
<span class="n">e</span>    <span class="n">NaN</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">55</span><span class="p">]:</span> <span class="n">obj3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">56</span><span class="p">]:</span> <span class="n">obj3</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">56</span><span class="p">]:</span> 
<span class="mi">0</span>      <span class="n">blue</span>
<span class="mi">2</span>    <span class="n">purple</span>
<span class="mi">4</span>    <span class="n">yellow</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="c1"># 对于时间序列这样的有序数据,重新索引时可能需要做插值处理。method选项即可达到此目的,例如,使用ffill以实现前向值填充:</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">57</span><span class="p">]:</span> <span class="n">obj3</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">57</span><span class="p">]:</span> 
<span class="mi">0</span>      <span class="n">blue</span>
<span class="mi">1</span>      <span class="n">blue</span>
<span class="mi">2</span>    <span class="n">purple</span>
<span class="mi">3</span>    <span class="n">purple</span>
<span class="mi">4</span>    <span class="n">yellow</span>
<span class="mi">5</span>    <span class="n">yellow</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="c1"># DataFrame中reindex可以调整行列</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">58</span><span class="p">]:</span> <span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
   <span class="o">....</span><span class="p">:</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">],</span>
   <span class="o">....</span><span class="p">:</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">,</span> <span class="s1">&#39;California&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">59</span><span class="p">]:</span> <span class="n">frame</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">59</span><span class="p">]:</span> 
   <span class="n">Ohio</span>  <span class="n">Texas</span>  <span class="n">California</span>
<span class="n">a</span>     <span class="mi">0</span>      <span class="mi">1</span>           <span class="mi">2</span>
<span class="n">c</span>     <span class="mi">3</span>      <span class="mi">4</span>           <span class="mi">5</span>
<span class="n">d</span>     <span class="mi">6</span>      <span class="mi">7</span>           <span class="mi">8</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">60</span><span class="p">]:</span> <span class="n">frame2</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">61</span><span class="p">]:</span> <span class="n">frame2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">61</span><span class="p">]:</span> 
   <span class="n">Ohio</span>  <span class="n">Texas</span>  <span class="n">California</span>
<span class="n">a</span>   <span class="mf">0.0</span>    <span class="mf">1.0</span>         <span class="mf">2.0</span>
<span class="n">b</span>   <span class="n">NaN</span>    <span class="n">NaN</span>         <span class="n">NaN</span>
<span class="n">c</span>   <span class="mf">3.0</span>    <span class="mf">4.0</span>         <span class="mf">5.0</span>
<span class="n">d</span>   <span class="mf">6.0</span>    <span class="mf">7.0</span>         <span class="mf">8.0</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">62</span><span class="p">]:</span> <span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Texas&#39;</span><span class="p">,</span> <span class="s1">&#39;Utah&#39;</span><span class="p">,</span> <span class="s1">&#39;California&#39;</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">63</span><span class="p">]:</span> <span class="n">frame</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">states</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">63</span><span class="p">]:</span> 
   <span class="n">Texas</span>  <span class="n">Utah</span>  <span class="n">California</span>
<span class="n">a</span>      <span class="mi">1</span>   <span class="n">NaN</span>           <span class="mi">2</span>
<span class="n">c</span>      <span class="mi">4</span>   <span class="n">NaN</span>           <span class="mi">5</span>
<span class="n">d</span>      <span class="mi">7</span>   <span class="n">NaN</span>           <span class="mi">8</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">69</span><span class="p">]:</span>  <span class="n">frame2</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">],</span><span class="n">columns</span><span class="o">=</span><span class="n">states</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">70</span><span class="p">]:</span> <span class="n">frame2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">70</span><span class="p">]:</span> 
   <span class="n">Texas</span>  <span class="n">Utah</span>  <span class="n">California</span>
<span class="n">a</span>    <span class="mf">1.0</span>   <span class="n">NaN</span>         <span class="mf">2.0</span>
<span class="n">b</span>    <span class="n">NaN</span>   <span class="n">NaN</span>         <span class="n">NaN</span>
<span class="n">c</span>    <span class="mf">4.0</span>   <span class="n">NaN</span>         <span class="mf">5.0</span>
<span class="n">d</span>    <span class="mf">7.0</span>   <span class="n">NaN</span>         <span class="mf">8.0</span>
</pre></div>
</td></tr></table>

<p>reindex函数的参数有index，method，fill_value，limit，tolerance，level，copy等。</p>
<p>更多参考：　https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.reindex.html</p>
<h4 id="_5">丢弃指定轴上的项</h4>
<p>丢弃某条轴上的一项很简单,只要有索引数组或列表即可。由于需要执行一些数据整理和集合逻辑,所以drop方法返回的是在指定轴上删除了指定值的新对象:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">71</span><span class="p">]:</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">5.</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">72</span><span class="p">]:</span> <span class="n">obj</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">72</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">0.0</span>
<span class="n">b</span>    <span class="mf">1.0</span>
<span class="n">c</span>    <span class="mf">2.0</span>
<span class="n">d</span>    <span class="mf">3.0</span>
<span class="n">e</span>    <span class="mf">4.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">73</span><span class="p">]:</span> <span class="n">new_obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">74</span><span class="p">]:</span> <span class="n">new_obj</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">74</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">0.0</span>
<span class="n">b</span>    <span class="mf">1.0</span>
<span class="n">d</span>    <span class="mf">3.0</span>
<span class="n">e</span>    <span class="mf">4.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">75</span><span class="p">]:</span> <span class="n">obj</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">75</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">0.0</span>
<span class="n">b</span>    <span class="mf">1.0</span>
<span class="n">c</span>    <span class="mf">2.0</span>
<span class="n">d</span>    <span class="mf">3.0</span>
<span class="n">e</span>    <span class="mf">4.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">76</span><span class="p">]:</span> <span class="n">obj</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">76</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">0.0</span>
<span class="n">b</span>    <span class="mf">1.0</span>
<span class="n">e</span>    <span class="mf">4.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">77</span><span class="p">]:</span> <span class="n">obj</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">77</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">0.0</span>
<span class="n">b</span>    <span class="mf">1.0</span>
<span class="n">c</span>    <span class="mf">2.0</span>
<span class="n">d</span>    <span class="mf">3.0</span>
<span class="n">e</span>    <span class="mf">4.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">78</span><span class="p">]:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
   <span class="o">....</span><span class="p">:</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Colorado&#39;</span><span class="p">,</span> <span class="s1">&#39;Utah&#39;</span><span class="p">,</span> <span class="s1">&#39;New York&#39;</span><span class="p">],</span>
   <span class="o">....</span><span class="p">:</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;four&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">79</span><span class="p">]:</span> <span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">79</span><span class="p">]:</span> 
          <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">Ohio</span>        <span class="mi">0</span>    <span class="mi">1</span>      <span class="mi">2</span>     <span class="mi">3</span>
<span class="n">Colorado</span>    <span class="mi">4</span>    <span class="mi">5</span>      <span class="mi">6</span>     <span class="mi">7</span>
<span class="n">Utah</span>        <span class="mi">8</span>    <span class="mi">9</span>     <span class="mi">10</span>    <span class="mi">11</span>
<span class="n">New</span> <span class="n">York</span>   <span class="mi">12</span>   <span class="mi">13</span>     <span class="mi">14</span>    <span class="mi">15</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">80</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Colorado&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">80</span><span class="p">]:</span> 
          <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">Utah</span>        <span class="mi">8</span>    <span class="mi">9</span>     <span class="mi">10</span>    <span class="mi">11</span>
<span class="n">New</span> <span class="n">York</span>   <span class="mi">12</span>   <span class="mi">13</span>     <span class="mi">14</span>    <span class="mi">15</span>

<span class="n">In</span> <span class="p">[]:</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;two&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">57</span><span class="p">]:</span> 
          <span class="n">one</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">Ohio</span>        <span class="mi">0</span>      <span class="mi">2</span>     <span class="mi">3</span>
<span class="n">Colorado</span>    <span class="mi">4</span>      <span class="mi">6</span>     <span class="mi">7</span>
<span class="n">Utah</span>        <span class="mi">8</span>     <span class="mi">10</span>    <span class="mi">11</span>
<span class="n">New</span> <span class="n">York</span>   <span class="mi">12</span>     <span class="mi">14</span>    <span class="mi">15</span>

<span class="n">In</span> <span class="p">[]:</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">58</span><span class="p">]:</span> 
          <span class="n">one</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">Ohio</span>        <span class="mi">0</span>      <span class="mi">2</span>     <span class="mi">3</span>
<span class="n">Colorado</span>    <span class="mi">4</span>      <span class="mi">6</span>     <span class="mi">7</span>
<span class="n">Utah</span>        <span class="mi">8</span>     <span class="mi">10</span>    <span class="mi">11</span>
<span class="n">New</span> <span class="n">York</span>   <span class="mi">12</span>     <span class="mi">14</span>    <span class="mi">15</span>

<span class="n">In</span> <span class="p">[]:</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;four&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">59</span><span class="p">]:</span> 
          <span class="n">one</span>  <span class="n">three</span>
<span class="n">Ohio</span>        <span class="mi">0</span>      <span class="mi">2</span>
<span class="n">Colorado</span>    <span class="mi">4</span>      <span class="mi">6</span>
<span class="n">Utah</span>        <span class="mi">8</span>     <span class="mi">10</span>
<span class="n">New</span> <span class="n">York</span>   <span class="mi">12</span>     <span class="mi">14</span>

<span class="n">In</span> <span class="p">[]:</span> <span class="n">obj</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[]:</span> <span class="n">obj</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">61</span><span class="p">]:</span> 
<span class="n">d</span>    <span class="mf">4.5</span>
<span class="n">b</span>    <span class="mf">7.2</span>
<span class="n">a</span>   <span class="o">-</span><span class="mf">5.3</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</td></tr></table>

<h4 id="_6">索引、选取和过滤</h4>
<p>Series索引(obj[...])的工作方式类似于NumPy数组的索引,只不过Series的索引值不只是整数。下面是几个例子:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">4.</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>

<span class="n">obj</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">63</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">0.0</span>
<span class="n">b</span>    <span class="mf">1.0</span>
<span class="n">c</span>    <span class="mf">2.0</span>
<span class="n">d</span>    <span class="mf">3.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">obj</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">64</span><span class="p">]:</span> <span class="mf">1.0</span>

<span class="n">obj</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">65</span><span class="p">]:</span> <span class="mf">1.0</span>

<span class="n">obj</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">66</span><span class="p">]:</span> 
<span class="n">c</span>    <span class="mf">2.0</span>
<span class="n">d</span>    <span class="mf">3.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">obj</span><span class="p">[[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">67</span><span class="p">]:</span> 
<span class="n">b</span>    <span class="mf">1.0</span>
<span class="n">a</span>    <span class="mf">0.0</span>
<span class="n">d</span>    <span class="mf">3.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">obj</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">68</span><span class="p">]:</span> 
<span class="n">b</span>    <span class="mf">1.0</span>
<span class="n">d</span>    <span class="mf">3.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">obj</span><span class="p">[</span><span class="n">obj</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">69</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">0.0</span>
<span class="n">b</span>    <span class="mf">1.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">obj</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">70</span><span class="p">]:</span> 
<span class="n">b</span>    <span class="mf">1.0</span>
<span class="n">c</span>    <span class="mf">2.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">obj</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">obj</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">72</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">0.0</span>
<span class="n">b</span>    <span class="mf">5.0</span>
<span class="n">c</span>    <span class="mf">5.0</span>
<span class="n">d</span>    <span class="mf">3.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</td></tr></table>

<p>注意标签的方式和python的列表不同，后面的index也是包含在里面的。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
<span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Colorado&#39;</span><span class="p">,</span> <span class="s1">&#39;Utah&#39;</span><span class="p">,</span> <span class="s1">&#39;New York&#39;</span><span class="p">],</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;four&#39;</span><span class="p">])</span>

<span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">74</span><span class="p">]:</span> 
          <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">Ohio</span>        <span class="mi">0</span>    <span class="mi">1</span>      <span class="mi">2</span>     <span class="mi">3</span>
<span class="n">Colorado</span>    <span class="mi">4</span>    <span class="mi">5</span>      <span class="mi">6</span>     <span class="mi">7</span>
<span class="n">Utah</span>        <span class="mi">8</span>    <span class="mi">9</span>     <span class="mi">10</span>    <span class="mi">11</span>
<span class="n">New</span> <span class="n">York</span>   <span class="mi">12</span>   <span class="mi">13</span>     <span class="mi">14</span>    <span class="mi">15</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;two&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">75</span><span class="p">]:</span> 
<span class="n">Ohio</span>         <span class="mi">1</span>
<span class="n">Colorado</span>     <span class="mi">5</span>
<span class="n">Utah</span>         <span class="mi">9</span>
<span class="n">New</span> <span class="n">York</span>    <span class="mi">13</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">two</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>

<span class="n">data</span><span class="p">[[</span><span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">]]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">76</span><span class="p">]:</span> 
          <span class="n">three</span>  <span class="n">one</span>
<span class="n">Ohio</span>          <span class="mi">2</span>    <span class="mi">0</span>
<span class="n">Colorado</span>      <span class="mi">6</span>    <span class="mi">4</span>
<span class="n">Utah</span>         <span class="mi">10</span>    <span class="mi">8</span>
<span class="n">New</span> <span class="n">York</span>     <span class="mi">14</span>   <span class="mi">12</span>

<span class="n">data</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">77</span><span class="p">]:</span> 
          <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">Ohio</span>        <span class="mi">0</span>    <span class="mi">1</span>      <span class="mi">2</span>     <span class="mi">3</span>
<span class="n">Colorado</span>    <span class="mi">4</span>    <span class="mi">5</span>      <span class="mi">6</span>     <span class="mi">7</span>

<span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;three&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">78</span><span class="p">]:</span> 
          <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">Colorado</span>    <span class="mi">4</span>    <span class="mi">5</span>      <span class="mi">6</span>     <span class="mi">7</span>
<span class="n">Utah</span>        <span class="mi">8</span>    <span class="mi">9</span>     <span class="mi">10</span>    <span class="mi">11</span>
<span class="n">New</span> <span class="n">York</span>   <span class="mi">12</span>   <span class="mi">13</span>     <span class="mi">14</span>    <span class="mi">15</span>

<span class="n">data</span> <span class="o">&lt;</span> <span class="mi">5</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">79</span><span class="p">]:</span> 
            <span class="n">one</span>    <span class="n">two</span>  <span class="n">three</span>   <span class="n">four</span>
<span class="n">Ohio</span>       <span class="bp">True</span>   <span class="bp">True</span>   <span class="bp">True</span>   <span class="bp">True</span>
<span class="n">Colorado</span>   <span class="bp">True</span>  <span class="bp">False</span>  <span class="bp">False</span>  <span class="bp">False</span>
<span class="n">Utah</span>      <span class="bp">False</span>  <span class="bp">False</span>  <span class="bp">False</span>  <span class="bp">False</span>
<span class="n">New</span> <span class="n">York</span>  <span class="bp">False</span>  <span class="bp">False</span>  <span class="bp">False</span>  <span class="bp">False</span>

<span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">81</span><span class="p">]:</span> 
          <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">Ohio</span>        <span class="mi">0</span>    <span class="mi">0</span>      <span class="mi">0</span>     <span class="mi">0</span>
<span class="n">Colorado</span>    <span class="mi">0</span>    <span class="mi">5</span>      <span class="mi">6</span>     <span class="mi">7</span>
<span class="n">Utah</span>        <span class="mi">8</span>    <span class="mi">9</span>     <span class="mi">10</span>    <span class="mi">11</span>
<span class="n">New</span> <span class="n">York</span>   <span class="mi">12</span>   <span class="mi">13</span>     <span class="mi">14</span>    <span class="mi">15</span>
</pre></div>
</td></tr></table>

<ul>
<li>loc和iloc</li>
</ul>
<p>对于行上的DataFrame标签索引有特殊的索引操作符loc(标签)和iloc(整数索引)能够从DataFrame中选择子集。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
<span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Colorado&#39;</span><span class="p">,</span> <span class="s1">&#39;Utah&#39;</span><span class="p">,</span> <span class="s1">&#39;New York&#39;</span><span class="p">],</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;four&#39;</span><span class="p">])</span>

<span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">74</span><span class="p">]:</span> 
          <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">Ohio</span>        <span class="mi">0</span>    <span class="mi">1</span>      <span class="mi">2</span>     <span class="mi">3</span>
<span class="n">Colorado</span>    <span class="mi">4</span>    <span class="mi">5</span>      <span class="mi">6</span>     <span class="mi">7</span>
<span class="n">Utah</span>        <span class="mi">8</span>    <span class="mi">9</span>     <span class="mi">10</span>    <span class="mi">11</span>
<span class="n">New</span> <span class="n">York</span>   <span class="mi">12</span>   <span class="mi">13</span>     <span class="mi">14</span>    <span class="mi">15</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;two&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">75</span><span class="p">]:</span> 
<span class="n">Ohio</span>         <span class="mi">1</span>
<span class="n">Colorado</span>     <span class="mi">5</span>
<span class="n">Utah</span>         <span class="mi">9</span>
<span class="n">New</span> <span class="n">York</span>    <span class="mi">13</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">two</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>

<span class="n">data</span><span class="p">[[</span><span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">]]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">76</span><span class="p">]:</span> 
          <span class="n">three</span>  <span class="n">one</span>
<span class="n">Ohio</span>          <span class="mi">2</span>    <span class="mi">0</span>
<span class="n">Colorado</span>      <span class="mi">6</span>    <span class="mi">4</span>
<span class="n">Utah</span>         <span class="mi">10</span>    <span class="mi">8</span>
<span class="n">New</span> <span class="n">York</span>     <span class="mi">14</span>   <span class="mi">12</span>

<span class="n">data</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">77</span><span class="p">]:</span> 
          <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">Ohio</span>        <span class="mi">0</span>    <span class="mi">1</span>      <span class="mi">2</span>     <span class="mi">3</span>
<span class="n">Colorado</span>    <span class="mi">4</span>    <span class="mi">5</span>      <span class="mi">6</span>     <span class="mi">7</span>

<span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;three&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">78</span><span class="p">]:</span> 
          <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">Colorado</span>    <span class="mi">4</span>    <span class="mi">5</span>      <span class="mi">6</span>     <span class="mi">7</span>
<span class="n">Utah</span>        <span class="mi">8</span>    <span class="mi">9</span>     <span class="mi">10</span>    <span class="mi">11</span>
<span class="n">New</span> <span class="n">York</span>   <span class="mi">12</span>   <span class="mi">13</span>     <span class="mi">14</span>    <span class="mi">15</span>

<span class="n">data</span> <span class="o">&lt;</span> <span class="mi">5</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">79</span><span class="p">]:</span> 
            <span class="n">one</span>    <span class="n">two</span>  <span class="n">three</span>   <span class="n">four</span>
<span class="n">Ohio</span>       <span class="bp">True</span>   <span class="bp">True</span>   <span class="bp">True</span>   <span class="bp">True</span>
<span class="n">Colorado</span>   <span class="bp">True</span>  <span class="bp">False</span>  <span class="bp">False</span>  <span class="bp">False</span>
<span class="n">Utah</span>      <span class="bp">False</span>  <span class="bp">False</span>  <span class="bp">False</span>  <span class="bp">False</span>
<span class="n">New</span> <span class="n">York</span>  <span class="bp">False</span>  <span class="bp">False</span>  <span class="bp">False</span>  <span class="bp">False</span>

<span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">81</span><span class="p">]:</span> 
          <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">Ohio</span>        <span class="mi">0</span>    <span class="mi">0</span>      <span class="mi">0</span>     <span class="mi">0</span>
<span class="n">Colorado</span>    <span class="mi">0</span>    <span class="mi">5</span>      <span class="mi">6</span>     <span class="mi">7</span>
<span class="n">Utah</span>        <span class="mi">8</span>    <span class="mi">9</span>     <span class="mi">10</span>    <span class="mi">11</span>
<span class="n">New</span> <span class="n">York</span>   <span class="mi">12</span>   <span class="mi">13</span>     <span class="mi">14</span>    <span class="mi">15</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Colorado&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">]]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">82</span><span class="p">]:</span> 
<span class="n">two</span>      <span class="mi">5</span>
<span class="n">three</span>    <span class="mi">6</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">Colorado</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>

<span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">83</span><span class="p">]:</span> 
<span class="n">four</span>    <span class="mi">11</span>
<span class="n">one</span>      <span class="mi">8</span>
<span class="n">two</span>      <span class="mi">9</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">Utah</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>

<span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">84</span><span class="p">]:</span> 
<span class="n">one</span>       <span class="mi">8</span>
<span class="n">two</span>       <span class="mi">9</span>
<span class="n">three</span>    <span class="mi">10</span>
<span class="n">four</span>     <span class="mi">11</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">Utah</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>

<span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">85</span><span class="p">]:</span> 
          <span class="n">four</span>  <span class="n">one</span>  <span class="n">two</span>
<span class="n">Colorado</span>     <span class="mi">7</span>    <span class="mi">0</span>    <span class="mi">5</span>
<span class="n">Utah</span>        <span class="mi">11</span>    <span class="mi">8</span>    <span class="mi">9</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s1">&#39;Utah&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">86</span><span class="p">]:</span> 
<span class="n">Ohio</span>        <span class="mi">0</span>
<span class="n">Colorado</span>    <span class="mi">5</span>
<span class="n">Utah</span>        <span class="mi">9</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">two</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>

<span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">][</span><span class="n">data</span><span class="o">.</span><span class="n">three</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">87</span><span class="p">]:</span> 
          <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>
<span class="n">Colorado</span>    <span class="mi">0</span>    <span class="mi">5</span>      <span class="mi">6</span>
<span class="n">Utah</span>        <span class="mi">8</span>    <span class="mi">9</span>     <span class="mi">10</span>
<span class="n">New</span> <span class="n">York</span>   <span class="mi">12</span>   <span class="mi">13</span>     <span class="mi">14</span>
</pre></div>
</td></tr></table>

<p>注意ix现在已经不推荐使用。</p>
<h4 id="integer-indexes">整数索引(Integer Indexes)</h4>
<p>pandas对象的整数索引与内置Python数据的索引语义存在一些差异，以下代码会生成错误：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">3.</span><span class="p">))</span>

<span class="n">ser</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>

  <span class="n">File</span> <span class="s2">&quot;&lt;ipython-input-20-3cbe0b873a9e&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">ser</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

  <span class="n">File</span> <span class="s2">&quot;C:\Users</span><span class="se">\a</span><span class="s2">ndrew\AppData\Local\conda\conda\envs\my_root\lib\site-packages\pandas\core\series.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">601</span><span class="p">,</span> <span class="ow">in</span> <span class="fm">__getitem__</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

  <span class="n">File</span> <span class="s2">&quot;C:\Users</span><span class="se">\a</span><span class="s2">ndrew\AppData\Local\conda\conda\envs\my_root\lib\site-packages\pandas\core\indexes</span><span class="se">\b</span><span class="s2">ase.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">2477</span><span class="p">,</span> <span class="ow">in</span> <span class="n">get_value</span>
    <span class="n">tz</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="s1">&#39;tz&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>

  <span class="n">File</span> <span class="s2">&quot;pandas\_libs\index.pyx&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">98</span><span class="p">,</span> <span class="ow">in</span> <span class="n">pandas</span><span class="o">.</span><span class="n">_libs</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">IndexEngine</span><span class="o">.</span><span class="n">get_value</span>

  <span class="n">File</span> <span class="s2">&quot;pandas\_libs\index.pyx&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">106</span><span class="p">,</span> <span class="ow">in</span> <span class="n">pandas</span><span class="o">.</span><span class="n">_libs</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">IndexEngine</span><span class="o">.</span><span class="n">get_value</span>

  <span class="n">File</span> <span class="s2">&quot;pandas\_libs\index.pyx&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">154</span><span class="p">,</span> <span class="ow">in</span> <span class="n">pandas</span><span class="o">.</span><span class="n">_libs</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">IndexEngine</span><span class="o">.</span><span class="n">get_loc</span>

  <span class="n">File</span> <span class="s2">&quot;pandas\_libs\hashtable_class_helper.pxi&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">759</span><span class="p">,</span> <span class="ow">in</span> <span class="n">pandas</span><span class="o">.</span><span class="n">_libs</span><span class="o">.</span><span class="n">hashtable</span><span class="o">.</span><span class="n">Int64HashTable</span><span class="o">.</span><span class="n">get_item</span>

  <span class="n">File</span> <span class="s2">&quot;pandas\_libs\hashtable_class_helper.pxi&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">765</span><span class="p">,</span> <span class="ow">in</span> <span class="n">pandas</span><span class="o">.</span><span class="n">_libs</span><span class="o">.</span><span class="n">hashtable</span><span class="o">.</span><span class="n">Int64HashTable</span><span class="o">.</span><span class="n">get_item</span>

<span class="ne">KeyError</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span>

<span class="n">ser2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">3.</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="n">ser2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="mf">2.0</span>

<span class="n">ser</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">23</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="mf">0.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">ser</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">24</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="mf">0.0</span>
<span class="mi">1</span>    <span class="mf">1.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">ser</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">25</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="mf">0.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</td></tr></table>

<h4 id="_7">算术和数据对齐</h4>
<p>pandas可在不同索引的对象建进行算术运算，类似数据库的连接：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">7.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.4</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>

<span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="o">-</span><span class="mf">2.1</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">])</span>

<span class="n">s1</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">28</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">7.3</span>
<span class="n">c</span>   <span class="o">-</span><span class="mf">2.5</span>
<span class="n">d</span>    <span class="mf">3.4</span>
<span class="n">e</span>    <span class="mf">1.5</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">s2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">29</span><span class="p">]:</span> 
<span class="n">a</span>   <span class="o">-</span><span class="mf">2.1</span>
<span class="n">c</span>    <span class="mf">3.6</span>
<span class="n">e</span>   <span class="o">-</span><span class="mf">1.5</span>
<span class="n">f</span>    <span class="mf">4.0</span>
<span class="n">g</span>    <span class="mf">3.1</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">s1</span> <span class="o">+</span> <span class="n">s2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">30</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">5.2</span>
<span class="n">c</span>    <span class="mf">1.1</span>
<span class="n">d</span>    <span class="n">NaN</span>
<span class="n">e</span>    <span class="mf">0.0</span>
<span class="n">f</span>    <span class="n">NaN</span>
<span class="n">g</span>    <span class="n">NaN</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">9.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;bcd&#39;</span><span class="p">),</span>
<span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">,</span> <span class="s1">&#39;Colorado&#39;</span><span class="p">])</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">12.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;bde&#39;</span><span class="p">),</span>
<span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Utah&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">,</span> <span class="s1">&#39;Oregon&#39;</span><span class="p">])</span>

<span class="n">df1</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">33</span><span class="p">]:</span> 
            <span class="n">b</span>    <span class="n">c</span>    <span class="n">d</span>
<span class="n">Ohio</span>      <span class="mf">0.0</span>  <span class="mf">1.0</span>  <span class="mf">2.0</span>
<span class="n">Texas</span>     <span class="mf">3.0</span>  <span class="mf">4.0</span>  <span class="mf">5.0</span>
<span class="n">Colorado</span>  <span class="mf">6.0</span>  <span class="mf">7.0</span>  <span class="mf">8.0</span>

<span class="n">df2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">34</span><span class="p">]:</span> 
          <span class="n">b</span>     <span class="n">d</span>     <span class="n">e</span>
<span class="n">Utah</span>    <span class="mf">0.0</span>   <span class="mf">1.0</span>   <span class="mf">2.0</span>
<span class="n">Ohio</span>    <span class="mf">3.0</span>   <span class="mf">4.0</span>   <span class="mf">5.0</span>
<span class="n">Texas</span>   <span class="mf">6.0</span>   <span class="mf">7.0</span>   <span class="mf">8.0</span>
<span class="n">Oregon</span>  <span class="mf">9.0</span>  <span class="mf">10.0</span>  <span class="mf">11.0</span>

<span class="n">df1</span> <span class="o">+</span> <span class="n">df2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">35</span><span class="p">]:</span> 
            <span class="n">b</span>   <span class="n">c</span>     <span class="n">d</span>   <span class="n">e</span>
<span class="n">Colorado</span>  <span class="n">NaN</span> <span class="n">NaN</span>   <span class="n">NaN</span> <span class="n">NaN</span>
<span class="n">Ohio</span>      <span class="mf">3.0</span> <span class="n">NaN</span>   <span class="mf">6.0</span> <span class="n">NaN</span>
<span class="n">Oregon</span>    <span class="n">NaN</span> <span class="n">NaN</span>   <span class="n">NaN</span> <span class="n">NaN</span>
<span class="n">Texas</span>     <span class="mf">9.0</span> <span class="n">NaN</span>  <span class="mf">12.0</span> <span class="n">NaN</span>
<span class="n">Utah</span>      <span class="n">NaN</span> <span class="n">NaN</span>   <span class="n">NaN</span> <span class="n">NaN</span>

<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>

<span class="n">df1</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">38</span><span class="p">]:</span> 
   <span class="n">A</span>
<span class="mi">0</span>  <span class="mi">1</span>
<span class="mi">1</span>  <span class="mi">2</span>

<span class="n">df2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">39</span><span class="p">]:</span> 
   <span class="n">B</span>
<span class="mi">0</span>  <span class="mi">3</span>
<span class="mi">1</span>  <span class="mi">4</span>

<span class="n">df1</span> <span class="o">-</span> <span class="n">df2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">40</span><span class="p">]:</span> 
    <span class="n">A</span>   <span class="n">B</span>
<span class="mi">0</span> <span class="n">NaN</span> <span class="n">NaN</span>
<span class="mi">1</span> <span class="n">NaN</span> <span class="n">NaN</span>
</pre></div>
</td></tr></table>

<p>还可以进行值的填充</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">12.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
<span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abcd&#39;</span><span class="p">))</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">20.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span>
<span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abcde&#39;</span><span class="p">))</span>

<span class="n">df1</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">43</span><span class="p">]:</span> 
     <span class="n">a</span>    <span class="n">b</span>     <span class="n">c</span>     <span class="n">d</span>
<span class="mi">0</span>  <span class="mf">0.0</span>  <span class="mf">1.0</span>   <span class="mf">2.0</span>   <span class="mf">3.0</span>
<span class="mi">1</span>  <span class="mf">4.0</span>  <span class="mf">5.0</span>   <span class="mf">6.0</span>   <span class="mf">7.0</span>
<span class="mi">2</span>  <span class="mf">8.0</span>  <span class="mf">9.0</span>  <span class="mf">10.0</span>  <span class="mf">11.0</span>

<span class="n">df2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">44</span><span class="p">]:</span> 
      <span class="n">a</span>     <span class="n">b</span>     <span class="n">c</span>     <span class="n">d</span>     <span class="n">e</span>
<span class="mi">0</span>   <span class="mf">0.0</span>   <span class="mf">1.0</span>   <span class="mf">2.0</span>   <span class="mf">3.0</span>   <span class="mf">4.0</span>
<span class="mi">1</span>   <span class="mf">5.0</span>   <span class="mf">6.0</span>   <span class="mf">7.0</span>   <span class="mf">8.0</span>   <span class="mf">9.0</span>
<span class="mi">2</span>  <span class="mf">10.0</span>  <span class="mf">11.0</span>  <span class="mf">12.0</span>  <span class="mf">13.0</span>  <span class="mf">14.0</span>
<span class="mi">3</span>  <span class="mf">15.0</span>  <span class="mf">16.0</span>  <span class="mf">17.0</span>  <span class="mf">18.0</span>  <span class="mf">19.0</span>

<span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="n">df2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">46</span><span class="p">]:</span> 
      <span class="n">a</span>     <span class="n">b</span>     <span class="n">c</span>     <span class="n">d</span>     <span class="n">e</span>
<span class="mi">0</span>   <span class="mf">0.0</span>   <span class="mf">1.0</span>   <span class="mf">2.0</span>   <span class="mf">3.0</span>   <span class="mf">4.0</span>
<span class="mi">1</span>   <span class="mf">5.0</span>   <span class="n">NaN</span>   <span class="mf">7.0</span>   <span class="mf">8.0</span>   <span class="mf">9.0</span>
<span class="mi">2</span>  <span class="mf">10.0</span>  <span class="mf">11.0</span>  <span class="mf">12.0</span>  <span class="mf">13.0</span>  <span class="mf">14.0</span>
<span class="mi">3</span>  <span class="mf">15.0</span>  <span class="mf">16.0</span>  <span class="mf">17.0</span>  <span class="mf">18.0</span>  <span class="mf">19.0</span>

<span class="n">df1</span> <span class="o">+</span> <span class="n">df2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">47</span><span class="p">]:</span> 
      <span class="n">a</span>     <span class="n">b</span>     <span class="n">c</span>     <span class="n">d</span>   <span class="n">e</span>
<span class="mi">0</span>   <span class="mf">0.0</span>   <span class="mf">2.0</span>   <span class="mf">4.0</span>   <span class="mf">6.0</span> <span class="n">NaN</span>
<span class="mi">1</span>   <span class="mf">9.0</span>   <span class="n">NaN</span>  <span class="mf">13.0</span>  <span class="mf">15.0</span> <span class="n">NaN</span>
<span class="mi">2</span>  <span class="mf">18.0</span>  <span class="mf">20.0</span>  <span class="mf">22.0</span>  <span class="mf">24.0</span> <span class="n">NaN</span>
<span class="mi">3</span>   <span class="n">NaN</span>   <span class="n">NaN</span>   <span class="n">NaN</span>   <span class="n">NaN</span> <span class="n">NaN</span>

<span class="n">df1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">48</span><span class="p">]:</span> 
      <span class="n">a</span>     <span class="n">b</span>     <span class="n">c</span>     <span class="n">d</span>     <span class="n">e</span>
<span class="mi">0</span>   <span class="mf">0.0</span>   <span class="mf">2.0</span>   <span class="mf">4.0</span>   <span class="mf">6.0</span>   <span class="mf">4.0</span>
<span class="mi">1</span>   <span class="mf">9.0</span>   <span class="mf">5.0</span>  <span class="mf">13.0</span>  <span class="mf">15.0</span>   <span class="mf">9.0</span>
<span class="mi">2</span>  <span class="mf">18.0</span>  <span class="mf">20.0</span>  <span class="mf">22.0</span>  <span class="mf">24.0</span>  <span class="mf">14.0</span>
<span class="mi">3</span>  <span class="mf">15.0</span>  <span class="mf">16.0</span>  <span class="mf">17.0</span>  <span class="mf">18.0</span>  <span class="mf">19.0</span>

<span class="mi">1</span> <span class="o">/</span> <span class="n">df1</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">49</span><span class="p">]:</span> 
          <span class="n">a</span>         <span class="n">b</span>         <span class="n">c</span>         <span class="n">d</span>
<span class="mi">0</span>       <span class="n">inf</span>  <span class="mf">1.000000</span>  <span class="mf">0.500000</span>  <span class="mf">0.333333</span>
<span class="mi">1</span>  <span class="mf">0.250000</span>  <span class="mf">0.200000</span>  <span class="mf">0.166667</span>  <span class="mf">0.142857</span>
<span class="mi">2</span>  <span class="mf">0.125000</span>  <span class="mf">0.111111</span>  <span class="mf">0.100000</span>  <span class="mf">0.090909</span>

<span class="n">df1</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">50</span><span class="p">]:</span> 
          <span class="n">a</span>         <span class="n">b</span>         <span class="n">c</span>         <span class="n">d</span>
<span class="mi">0</span>       <span class="n">inf</span>  <span class="mf">1.000000</span>  <span class="mf">0.500000</span>  <span class="mf">0.333333</span>
<span class="mi">1</span>  <span class="mf">0.250000</span>  <span class="mf">0.200000</span>  <span class="mf">0.166667</span>  <span class="mf">0.142857</span>
<span class="mi">2</span>  <span class="mf">0.125000</span>  <span class="mf">0.111111</span>  <span class="mf">0.100000</span>  <span class="mf">0.090909</span>


<span class="n">df1</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">df2</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">53</span><span class="p">]:</span> 
     <span class="n">a</span>    <span class="n">b</span>     <span class="n">c</span>     <span class="n">d</span>  <span class="n">e</span>
<span class="mi">0</span>  <span class="mf">0.0</span>  <span class="mf">1.0</span>   <span class="mf">2.0</span>   <span class="mf">3.0</span>  <span class="mi">0</span>
<span class="mi">1</span>  <span class="mf">4.0</span>  <span class="mf">5.0</span>   <span class="mf">6.0</span>   <span class="mf">7.0</span>  <span class="mi">0</span>
<span class="mi">2</span>  <span class="mf">8.0</span>  <span class="mf">9.0</span>  <span class="mf">10.0</span>  <span class="mf">11.0</span>  <span class="mi">0</span>
</pre></div>
</td></tr></table>

<table>
<thead>
<tr>
<th align="center">Method</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">add, radd</td>
<td align="center">for addition (+)</td>
</tr>
<tr>
<td align="center">sub, rsub</td>
<td align="center">for subtraction (-)</td>
</tr>
<tr>
<td align="center">div, rdiv</td>
<td align="center">for division (/)</td>
</tr>
<tr>
<td align="center">floordiv, rfloordiv</td>
<td align="center">for floor division (//)</td>
</tr>
<tr>
<td align="center">mul, rmul</td>
<td align="center">for multiplication (*)</td>
</tr>
<tr>
<td align="center">pow, rpow</td>
<td align="center">for exponentiation (**)</td>
</tr>
</tbody>
</table>
<ul>
<li>DataFrame和Series间的操作</li>
</ul>
<p>默认基于行进行广播，用( axis='index' or axis=0 )可以基于列进行广播。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">12.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">55</span><span class="p">]:</span> 
<span class="n">array</span><span class="p">([[</span>  <span class="mf">0.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">2.</span><span class="p">,</span>   <span class="mf">3.</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">4.</span><span class="p">,</span>   <span class="mf">5.</span><span class="p">,</span>   <span class="mf">6.</span><span class="p">,</span>   <span class="mf">7.</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">8.</span><span class="p">,</span>   <span class="mf">9.</span><span class="p">,</span>  <span class="mf">10.</span><span class="p">,</span>  <span class="mf">11.</span><span class="p">]])</span>

<span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">56</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>

<span class="n">arr</span> <span class="o">-</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">57</span><span class="p">]:</span> 
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">4.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span><span class="p">,</span>  <span class="mf">8.</span><span class="p">,</span>  <span class="mf">8.</span><span class="p">,</span>  <span class="mf">8.</span><span class="p">]])</span>

<span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">58</span><span class="p">]:</span> 
<span class="n">array</span><span class="p">([[</span>  <span class="mf">0.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">2.</span><span class="p">,</span>   <span class="mf">3.</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">4.</span><span class="p">,</span>   <span class="mf">5.</span><span class="p">,</span>   <span class="mf">6.</span><span class="p">,</span>   <span class="mf">7.</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">8.</span><span class="p">,</span>   <span class="mf">9.</span><span class="p">,</span>  <span class="mf">10.</span><span class="p">,</span>  <span class="mf">11.</span><span class="p">]])</span>

<span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">12.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
<span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;bde&#39;</span><span class="p">),</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Utah&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">,</span> <span class="s1">&#39;Oregon&#39;</span><span class="p">])</span>

<span class="n">series</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">frame</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">61</span><span class="p">]:</span> 
          <span class="n">b</span>     <span class="n">d</span>     <span class="n">e</span>
<span class="n">Utah</span>    <span class="mf">0.0</span>   <span class="mf">1.0</span>   <span class="mf">2.0</span>
<span class="n">Ohio</span>    <span class="mf">3.0</span>   <span class="mf">4.0</span>   <span class="mf">5.0</span>
<span class="n">Texas</span>   <span class="mf">6.0</span>   <span class="mf">7.0</span>   <span class="mf">8.0</span>
<span class="n">Oregon</span>  <span class="mf">9.0</span>  <span class="mf">10.0</span>  <span class="mf">11.0</span>

<span class="n">series</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">62</span><span class="p">]:</span> 
<span class="n">b</span>    <span class="mf">0.0</span>
<span class="n">d</span>    <span class="mf">1.0</span>
<span class="n">e</span>    <span class="mf">2.0</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">Utah</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">frame</span> <span class="o">-</span> <span class="n">series</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">63</span><span class="p">]:</span> 
          <span class="n">b</span>    <span class="n">d</span>    <span class="n">e</span>
<span class="n">Utah</span>    <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>
<span class="n">Ohio</span>    <span class="mf">3.0</span>  <span class="mf">3.0</span>  <span class="mf">3.0</span>
<span class="n">Texas</span>   <span class="mf">6.0</span>  <span class="mf">6.0</span>  <span class="mf">6.0</span>
<span class="n">Oregon</span>  <span class="mf">9.0</span>  <span class="mf">9.0</span>  <span class="mf">9.0</span>

<span class="n">series2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">])</span>

<span class="n">series2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">65</span><span class="p">]:</span> 
<span class="n">b</span>    <span class="mi">0</span>
<span class="n">e</span>    <span class="mi">1</span>
<span class="n">f</span>    <span class="mi">2</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>

<span class="n">frame</span> <span class="o">+</span> <span class="n">series2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">66</span><span class="p">]:</span> 
          <span class="n">b</span>   <span class="n">d</span>     <span class="n">e</span>   <span class="n">f</span>
<span class="n">Utah</span>    <span class="mf">0.0</span> <span class="n">NaN</span>   <span class="mf">3.0</span> <span class="n">NaN</span>
<span class="n">Ohio</span>    <span class="mf">3.0</span> <span class="n">NaN</span>   <span class="mf">6.0</span> <span class="n">NaN</span>
<span class="n">Texas</span>   <span class="mf">6.0</span> <span class="n">NaN</span>   <span class="mf">9.0</span> <span class="n">NaN</span>
<span class="n">Oregon</span>  <span class="mf">9.0</span> <span class="n">NaN</span>  <span class="mf">12.0</span> <span class="n">NaN</span>


<span class="n">series3</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span>

<span class="n">frame</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">69</span><span class="p">]:</span> 
          <span class="n">b</span>     <span class="n">d</span>     <span class="n">e</span>
<span class="n">Utah</span>    <span class="mf">0.0</span>   <span class="mf">1.0</span>   <span class="mf">2.0</span>
<span class="n">Ohio</span>    <span class="mf">3.0</span>   <span class="mf">4.0</span>   <span class="mf">5.0</span>
<span class="n">Texas</span>   <span class="mf">6.0</span>   <span class="mf">7.0</span>   <span class="mf">8.0</span>
<span class="n">Oregon</span>  <span class="mf">9.0</span>  <span class="mf">10.0</span>  <span class="mf">11.0</span>

<span class="n">series3</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">70</span><span class="p">]:</span> 
<span class="n">Utah</span>       <span class="mf">1.0</span>
<span class="n">Ohio</span>       <span class="mf">4.0</span>
<span class="n">Texas</span>      <span class="mf">7.0</span>
<span class="n">Oregon</span>    <span class="mf">10.0</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">d</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">frame</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">series3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">71</span><span class="p">]:</span> 
          <span class="n">b</span>    <span class="n">d</span>    <span class="n">e</span>
<span class="n">Utah</span>   <span class="o">-</span><span class="mf">1.0</span>  <span class="mf">0.0</span>  <span class="mf">1.0</span>
<span class="n">Ohio</span>   <span class="o">-</span><span class="mf">1.0</span>  <span class="mf">0.0</span>  <span class="mf">1.0</span>
<span class="n">Texas</span>  <span class="o">-</span><span class="mf">1.0</span>  <span class="mf">0.0</span>  <span class="mf">1.0</span>
<span class="n">Oregon</span> <span class="o">-</span><span class="mf">1.0</span>  <span class="mf">0.0</span>  <span class="mf">1.0</span>
</pre></div>
</td></tr></table>

<h4 id="_8">函数应用和映射</h4>
<p>NumPy的ufuncs（元素级数组方法）也可用于操作pandas对象：</p>
<p>另一个常见的操作是将函数应用到由各列或行所形成的一维数组上。DataFrame的apply方法即可实现此功能：</p>
<p>许多最为常见的数组统计功能都被实现成DataFrame的方法（如sum和mean），因此无需使用apply方法。除标量值外，传递给apply的函数还可以返回由多个值组成的Series：</p>
<p>此外，元素级的Python函数也是可以用的。假如你想得到frame中各个浮点值的格式化字符串，使用applymap即可：</p>
<p>之所以叫做applymap，是因为Series有一个用于应用元素级函数的map方法：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">12.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">73</span><span class="p">]:</span> 
<span class="n">array</span><span class="p">([[</span>  <span class="mf">0.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>   <span class="mf">2.</span><span class="p">,</span>   <span class="mf">3.</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">4.</span><span class="p">,</span>   <span class="mf">5.</span><span class="p">,</span>   <span class="mf">6.</span><span class="p">,</span>   <span class="mf">7.</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">8.</span><span class="p">,</span>   <span class="mf">9.</span><span class="p">,</span>  <span class="mf">10.</span><span class="p">,</span>  <span class="mf">11.</span><span class="p">]])</span>

<span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">74</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>

<span class="n">arr</span> <span class="o">-</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">75</span><span class="p">]:</span> 
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">4.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">8.</span><span class="p">,</span>  <span class="mf">8.</span><span class="p">,</span>  <span class="mf">8.</span><span class="p">,</span>  <span class="mf">8.</span><span class="p">]])</span>





<span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;bde&#39;</span><span class="p">),</span>
<span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Utah&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">,</span> <span class="s1">&#39;Oregon&#39;</span><span class="p">])</span>

<span class="n">frame</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">77</span><span class="p">]:</span> 
               <span class="n">b</span>         <span class="n">d</span>         <span class="n">e</span>
<span class="n">Utah</span>    <span class="mf">0.255395</span>  <span class="mf">1.983985</span>  <span class="mf">0.936326</span>
<span class="n">Ohio</span>    <span class="mf">0.319394</span>  <span class="mf">2.231544</span> <span class="o">-</span><span class="mf">0.051256</span>
<span class="n">Texas</span>  <span class="o">-</span><span class="mf">0.041388</span> <span class="o">-</span><span class="mf">0.026032</span> <span class="o">-</span><span class="mf">0.446722</span>
<span class="n">Oregon</span>  <span class="mf">1.099475</span> <span class="o">-</span><span class="mf">1.432638</span> <span class="o">-</span><span class="mf">0.919189</span>

<span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">78</span><span class="p">]:</span> 
               <span class="n">b</span>         <span class="n">d</span>         <span class="n">e</span>
<span class="n">Utah</span>    <span class="mf">0.255395</span>  <span class="mf">1.983985</span>  <span class="mf">0.936326</span>
<span class="n">Ohio</span>    <span class="mf">0.319394</span>  <span class="mf">2.231544</span>  <span class="mf">0.051256</span>
<span class="n">Texas</span>   <span class="mf">0.041388</span>  <span class="mf">0.026032</span>  <span class="mf">0.446722</span>
<span class="n">Oregon</span>  <span class="mf">1.099475</span>  <span class="mf">1.432638</span>  <span class="mf">0.919189</span>

<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

<span class="n">frame</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">80</span><span class="p">]:</span> 
<span class="n">b</span>    <span class="mf">1.140863</span>
<span class="n">d</span>    <span class="mf">3.664181</span>
<span class="n">e</span>    <span class="mf">1.855515</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">frame</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">81</span><span class="p">]:</span> 
<span class="n">Utah</span>      <span class="mf">1.728590</span>
<span class="n">Ohio</span>      <span class="mf">2.282800</span>
<span class="n">Texas</span>     <span class="mf">0.420690</span>
<span class="n">Oregon</span>    <span class="mf">2.532113</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">])</span>


<span class="n">frame</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">83</span><span class="p">]:</span> 
            <span class="n">b</span>         <span class="n">d</span>         <span class="n">e</span>
<span class="nb">min</span> <span class="o">-</span><span class="mf">0.041388</span> <span class="o">-</span><span class="mf">1.432638</span> <span class="o">-</span><span class="mf">0.919189</span>
<span class="nb">max</span>  <span class="mf">1.099475</span>  <span class="mf">2.231544</span>  <span class="mf">0.936326</span>

<span class="n">format</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span>

<span class="n">frame</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="n">format</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">85</span><span class="p">]:</span> 
            <span class="n">b</span>      <span class="n">d</span>      <span class="n">e</span>
<span class="n">Utah</span>     <span class="mf">0.26</span>   <span class="mf">1.98</span>   <span class="mf">0.94</span>
<span class="n">Ohio</span>     <span class="mf">0.32</span>   <span class="mf">2.23</span>  <span class="o">-</span><span class="mf">0.05</span>
<span class="n">Texas</span>   <span class="o">-</span><span class="mf">0.04</span>  <span class="o">-</span><span class="mf">0.03</span>  <span class="o">-</span><span class="mf">0.45</span>
<span class="n">Oregon</span>   <span class="mf">1.10</span>  <span class="o">-</span><span class="mf">1.43</span>  <span class="o">-</span><span class="mf">0.92</span>

<span class="n">frame</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">format</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">86</span><span class="p">]:</span> 
<span class="n">Utah</span>       <span class="mf">0.94</span>
<span class="n">Ohio</span>      <span class="o">-</span><span class="mf">0.05</span>
<span class="n">Texas</span>     <span class="o">-</span><span class="mf">0.45</span>
<span class="n">Oregon</span>    <span class="o">-</span><span class="mf">0.92</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">e</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</td></tr></table>

<h4 id="_9">排序和排名</h4>
<p>根据条件对数据集排序（sorting）也是重要的内置运算。要对行或列索引进行排序（按字典顺序），可使用sort_index方法，它将返回一个已排序的新对象。</p>
<p>而对于DataFrame，则可以根据任意轴上的索引进行排序：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="n">obj</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">88</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mi">1</span>
<span class="n">b</span>    <span class="mi">2</span>
<span class="n">c</span>    <span class="mi">3</span>
<span class="n">d</span>    <span class="mi">0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>

<span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
<span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">],</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="n">frame</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">90</span><span class="p">]:</span> 
       <span class="n">d</span>  <span class="n">a</span>  <span class="n">b</span>  <span class="n">c</span>
<span class="n">three</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>
<span class="n">one</span>    <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>

<span class="n">frame</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">91</span><span class="p">]:</span> 
       <span class="n">d</span>  <span class="n">a</span>  <span class="n">b</span>  <span class="n">c</span>
<span class="n">one</span>    <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>
<span class="n">three</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>

<span class="n">frame</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">94</span><span class="p">]:</span> 
       <span class="n">a</span>  <span class="n">b</span>  <span class="n">c</span>  <span class="n">d</span>
<span class="n">three</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">0</span>
<span class="n">one</span>    <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">4</span>
</pre></div>
</td></tr></table>

<p>数据默认是按升序排序的，但也可以降序排序，若要按值对Series进行排序，可使用其order方法。在排序时，任何缺失值默认都会被放到Series的末尾。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">frame</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">95</span><span class="p">]:</span> 
       <span class="n">d</span>  <span class="n">c</span>  <span class="n">b</span>  <span class="n">a</span>
<span class="n">three</span>  <span class="mi">0</span>  <span class="mi">3</span>  <span class="mi">2</span>  <span class="mi">1</span>
<span class="n">one</span>    <span class="mi">4</span>  <span class="mi">7</span>  <span class="mi">6</span>  <span class="mi">5</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="n">obj</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">97</span><span class="p">]:</span> 
<span class="mi">2</span>   <span class="o">-</span><span class="mi">3</span>
<span class="mi">3</span>    <span class="mi">2</span>
<span class="mi">0</span>    <span class="mi">4</span>
<span class="mi">1</span>    <span class="mi">7</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="n">obj</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">99</span><span class="p">]:</span> 
<span class="mi">4</span>   <span class="o">-</span><span class="mf">3.0</span>
<span class="mi">5</span>    <span class="mf">2.0</span>
<span class="mi">0</span>    <span class="mf">4.0</span>
<span class="mi">2</span>    <span class="mf">7.0</span>
<span class="mi">1</span>    <span class="n">NaN</span>
<span class="mi">3</span>    <span class="n">NaN</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">obj</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">100</span><span class="p">]:</span> 
<span class="mi">2</span>    <span class="mf">7.0</span>
<span class="mi">0</span>    <span class="mf">4.0</span>
<span class="mi">5</span>    <span class="mf">2.0</span>
<span class="mi">4</span>   <span class="o">-</span><span class="mf">3.0</span>
<span class="mi">1</span>    <span class="n">NaN</span>
<span class="mi">3</span>    <span class="n">NaN</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</td></tr></table>

<p>在DataFrame上，你可能希望根据一个或多个列中的值进行排序。将一个或多个列的名字传递给by选项即可。要根据多个列进行排序，传入名称的列表即可：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>

<span class="n">frame</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">102</span><span class="p">]:</span> 
   <span class="n">a</span>  <span class="n">b</span>
<span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">4</span>
<span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">7</span>
<span class="mi">2</span>  <span class="mi">0</span> <span class="o">-</span><span class="mi">3</span>
<span class="mi">3</span>  <span class="mi">1</span>  <span class="mi">2</span>

<span class="n">frame</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">103</span><span class="p">]:</span> 
   <span class="n">a</span>  <span class="n">b</span>
<span class="mi">2</span>  <span class="mi">0</span> <span class="o">-</span><span class="mi">3</span>
<span class="mi">3</span>  <span class="mi">1</span>  <span class="mi">2</span>
<span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">4</span>
<span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">7</span>

<span class="n">frame</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">104</span><span class="p">]:</span> 
   <span class="n">a</span>  <span class="n">b</span>
<span class="mi">2</span>  <span class="mi">0</span> <span class="o">-</span><span class="mi">3</span>
<span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">4</span>
<span class="mi">3</span>  <span class="mi">1</span>  <span class="mi">2</span>
<span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">7</span>
</pre></div>
</td></tr></table>

<p>排名（ranking）跟排序关系密切，且它会增设排名值（从1开始，一直到数组中有效数据的数量）。它跟numpy.argsort产生的间接排序索引差不多，只不过它可以根据某种规则破坏平级关系。接下来介绍Series和DataFrame的rank方法。默认情况下，rank是通过“为各组分配一个平均排名”的方式破坏平级关系的：</p>
<p>也可以根据值在原数据中出现的顺序给出排名</p>
<p>当然，你也可以按降序进行排名：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="n">obj</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">106</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="mf">6.5</span>
<span class="mi">1</span>    <span class="mf">1.0</span>
<span class="mi">2</span>    <span class="mf">6.5</span>
<span class="mi">3</span>    <span class="mf">4.5</span>
<span class="mi">4</span>    <span class="mf">3.0</span>
<span class="mi">5</span>    <span class="mf">2.0</span>
<span class="mi">6</span>    <span class="mf">4.5</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">obj</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">107</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="mf">6.0</span>
<span class="mi">1</span>    <span class="mf">1.0</span>
<span class="mi">2</span>    <span class="mf">7.0</span>
<span class="mi">3</span>    <span class="mf">4.0</span>
<span class="mi">4</span>    <span class="mf">3.0</span>
<span class="mi">5</span>    <span class="mf">2.0</span>
<span class="mi">6</span>    <span class="mf">5.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">obj</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">108</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="mf">2.0</span>
<span class="mi">1</span>    <span class="mf">7.0</span>
<span class="mi">2</span>    <span class="mf">2.0</span>
<span class="mi">3</span>    <span class="mf">4.0</span>
<span class="mi">4</span>    <span class="mf">5.0</span>
<span class="mi">5</span>    <span class="mf">6.0</span>
<span class="mi">6</span>    <span class="mf">4.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">]})</span>

<span class="n">frame</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">110</span><span class="p">]:</span> 
   <span class="n">a</span>    <span class="n">b</span>    <span class="n">c</span>
<span class="mi">0</span>  <span class="mi">0</span>  <span class="mf">4.3</span> <span class="o">-</span><span class="mf">2.0</span>
<span class="mi">1</span>  <span class="mi">1</span>  <span class="mf">7.0</span>  <span class="mf">5.0</span>
<span class="mi">2</span>  <span class="mi">0</span> <span class="o">-</span><span class="mf">3.0</span>  <span class="mf">8.0</span>
<span class="mi">3</span>  <span class="mi">1</span>  <span class="mf">2.0</span> <span class="o">-</span><span class="mf">2.5</span>

<span class="n">frame</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">111</span><span class="p">]:</span> 
     <span class="n">a</span>    <span class="n">b</span>    <span class="n">c</span>
<span class="mi">0</span>  <span class="mf">2.0</span>  <span class="mf">3.0</span>  <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mf">1.0</span>  <span class="mf">3.0</span>  <span class="mf">2.0</span>
<span class="mi">2</span>  <span class="mf">2.0</span>  <span class="mf">1.0</span>  <span class="mf">3.0</span>
<span class="mi">3</span>  <span class="mf">2.0</span>  <span class="mf">3.0</span>  <span class="mf">1.0</span>
</pre></div>
</td></tr></table>

<table>
<thead>
<tr>
<th align="center">Method</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">'average'</td>
<td align="center">Default: assign the average rank to each entry in the equal group</td>
</tr>
<tr>
<td align="center">'min'</td>
<td align="center">Use the minimum rank for the whole group</td>
</tr>
<tr>
<td align="center">'max'</td>
<td align="center">Use the maximum rank for the whole group</td>
</tr>
<tr>
<td align="center">'first'</td>
<td align="center">Assign ranks in the order the values appear in the data</td>
</tr>
<tr>
<td align="center">'dense'</td>
<td align="center">Like method='min' , but ranks always increase by 1 in between groups rather than the number of equal</td>
</tr>
<tr>
<td align="center">elements in a group</td>
<td align="center"></td>
</tr>
</tbody>
</table>
<h4 id="_10">带有重复值的轴索引</h4>
<p>直到目前为止，我所介绍的所有范例都有着唯一的轴标签（索引值）。虽然许多pandas函数（如reindex）都要求标签唯一，但这并不是强制性的。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="n">obj</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mi">0</span>
<span class="n">a</span>    <span class="mi">1</span>
<span class="n">b</span>    <span class="mi">2</span>
<span class="n">b</span>    <span class="mi">3</span>
<span class="n">c</span>    <span class="mi">4</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>

<span class="n">obj</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_unique</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="bp">False</span>

<span class="n">obj</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mi">0</span>
<span class="n">a</span>    <span class="mi">1</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>

<span class="n">obj</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="mi">4</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>

<span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> 
          <span class="mi">0</span>         <span class="mi">1</span>         <span class="mi">2</span>
<span class="n">a</span>  <span class="mf">0.835470</span>  <span class="mf">0.465657</span> <span class="o">-</span><span class="mf">0.068212</span>
<span class="n">a</span> <span class="o">-</span><span class="mf">1.067020</span>  <span class="mf">1.148283</span>  <span class="mf">1.722324</span>
<span class="n">b</span>  <span class="mf">0.057184</span> <span class="o">-</span><span class="mf">0.441111</span> <span class="o">-</span><span class="mf">0.388286</span>
<span class="n">b</span> <span class="o">-</span><span class="mf">0.363911</span> <span class="o">-</span><span class="mf">0.599963</span>  <span class="mf">0.126594</span>

<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> 
          <span class="mi">0</span>         <span class="mi">1</span>         <span class="mi">2</span>
<span class="n">b</span>  <span class="mf">0.057184</span> <span class="o">-</span><span class="mf">0.441111</span> <span class="o">-</span><span class="mf">0.388286</span>
<span class="n">b</span> <span class="o">-</span><span class="mf">0.363911</span> <span class="o">-</span><span class="mf">0.599963</span>  <span class="mf">0.126594</span>
</pre></div>
</td></tr></table>

<h3 id="_11">汇总和计算描述统计</h3>
<p>pandas对象拥有一组常用的数学和统计方法。它们大部分都属于reduction和summary统计，用于从Series中提取单个值（如sum或mean）或从DataFrame的行或列中提取Series。跟对应的NumPy数组方法相比，它们都是基于没有缺失数据的假设而构建的。接下来看一个简单DataFrame：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mf">1.4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.5</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.3</span><span class="p">]],</span> 
<span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">],</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">])</span>

<span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> 
    <span class="n">one</span>  <span class="n">two</span>
<span class="n">a</span>  <span class="mf">1.40</span>  <span class="n">NaN</span>
<span class="n">b</span>  <span class="mf">7.10</span> <span class="o">-</span><span class="mf">4.5</span>
<span class="n">c</span>   <span class="n">NaN</span>  <span class="n">NaN</span>
<span class="n">d</span>  <span class="mf">0.75</span> <span class="o">-</span><span class="mf">1.3</span>

<span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> 
<span class="n">one</span>    <span class="mf">9.25</span>
<span class="n">two</span>   <span class="o">-</span><span class="mf">5.80</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">1.40</span>
<span class="n">b</span>    <span class="mf">2.60</span>
<span class="n">c</span>    <span class="mf">0.00</span>
<span class="n">d</span>   <span class="o">-</span><span class="mf">0.55</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> 
<span class="n">a</span>      <span class="n">NaN</span>
<span class="n">b</span>    <span class="mf">1.300</span>
<span class="n">c</span>      <span class="n">NaN</span>
<span class="n">d</span>   <span class="o">-</span><span class="mf">0.275</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mf">1.400</span>
<span class="n">b</span>    <span class="mf">1.300</span>
<span class="n">c</span>      <span class="n">NaN</span>
<span class="n">d</span>   <span class="o">-</span><span class="mf">0.275</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</td></tr></table>

<table>
<thead>
<tr>
<th align="center">Method</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">axis</td>
<td align="center">Axis to reduce over; 0 for DataFrame’s rows and 1 for columns</td>
</tr>
<tr>
<td align="center">skipna</td>
<td align="center">Exclude missing values; True by default</td>
</tr>
<tr>
<td align="center">level</td>
<td align="center">Reduce grouped by level if the axis is hierarchically indexed (MultiIndex)</td>
</tr>
</tbody>
</table>
<p>有些方法（如idxmin和idxmax）返回的是间接统计（比如达到最小值或最大值的索引）,cumsum则为累计求和，describe则为汇总统计。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">19</span><span class="p">]:</span> 
    <span class="n">one</span>  <span class="n">two</span>
<span class="n">a</span>  <span class="mf">1.40</span>  <span class="n">NaN</span>
<span class="n">b</span>  <span class="mf">7.10</span> <span class="o">-</span><span class="mf">4.5</span>
<span class="n">c</span>   <span class="n">NaN</span>  <span class="n">NaN</span>
<span class="n">d</span>  <span class="mf">0.75</span> <span class="o">-</span><span class="mf">1.3</span>

<span class="n">df</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">20</span><span class="p">]:</span> 
<span class="n">one</span>    <span class="n">b</span>
<span class="n">two</span>    <span class="n">d</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="n">df</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">21</span><span class="p">]:</span> 
    <span class="n">one</span>  <span class="n">two</span>
<span class="n">a</span>  <span class="mf">1.40</span>  <span class="n">NaN</span>
<span class="n">b</span>  <span class="mf">8.50</span> <span class="o">-</span><span class="mf">4.5</span>
<span class="n">c</span>   <span class="n">NaN</span>  <span class="n">NaN</span>
<span class="n">d</span>  <span class="mf">9.25</span> <span class="o">-</span><span class="mf">5.8</span>

<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">22</span><span class="p">]:</span> 
            <span class="n">one</span>       <span class="n">two</span>
<span class="n">count</span>  <span class="mf">3.000000</span>  <span class="mf">2.000000</span>
<span class="n">mean</span>   <span class="mf">3.083333</span> <span class="o">-</span><span class="mf">2.900000</span>
<span class="n">std</span>    <span class="mf">3.493685</span>  <span class="mf">2.262742</span>
<span class="nb">min</span>    <span class="mf">0.750000</span> <span class="o">-</span><span class="mf">4.500000</span>
<span class="mi">25</span><span class="o">%</span>    <span class="mf">1.075000</span> <span class="o">-</span><span class="mf">3.700000</span>
<span class="mi">50</span><span class="o">%</span>    <span class="mf">1.400000</span> <span class="o">-</span><span class="mf">2.900000</span>
<span class="mi">75</span><span class="o">%</span>    <span class="mf">4.250000</span> <span class="o">-</span><span class="mf">2.100000</span>
<span class="nb">max</span>    <span class="mf">7.100000</span> <span class="o">-</span><span class="mf">1.300000</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">obj</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">24</span><span class="p">]:</span> 
<span class="n">count</span>     <span class="mi">16</span>
<span class="n">unique</span>     <span class="mi">3</span>
<span class="n">top</span>        <span class="n">a</span>
<span class="n">freq</span>       <span class="mi">8</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</td></tr></table>

<table>
<thead>
<tr>
<th align="center">Method</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">count</td>
<td align="center">Number of non-NA values</td>
</tr>
<tr>
<td align="center">describe</td>
<td align="center">Compute set of summary statistics for Series or each DataFrame column</td>
</tr>
<tr>
<td align="center">min, max</td>
<td align="center">Compute minimum and maximum values</td>
</tr>
<tr>
<td align="center">argmin, argmax</td>
<td align="center">Compute index locations (integers) at which minimum or maximum value obtained, respectively</td>
</tr>
<tr>
<td align="center">idxmin, idxmax</td>
<td align="center">Compute index labels at which minimum or maximum value obtained, respectively</td>
</tr>
<tr>
<td align="center">quantile</td>
<td align="center">Compute sample quantile ranging from 0 to 1</td>
</tr>
<tr>
<td align="center">sum</td>
<td align="center">Sum of values</td>
</tr>
<tr>
<td align="center">mean</td>
<td align="center">Mean of values</td>
</tr>
<tr>
<td align="center">median</td>
<td align="center">Arithmetic median (50% quantile) of values</td>
</tr>
<tr>
<td align="center">mad</td>
<td align="center">Mean absolute deviation from mean value</td>
</tr>
<tr>
<td align="center">prod</td>
<td align="center">Product of all values</td>
</tr>
<tr>
<td align="center">var</td>
<td align="center">Sample variance of values</td>
</tr>
<tr>
<td align="center">std</td>
<td align="center">Sample standard deviation of values</td>
</tr>
<tr>
<td align="center">skew</td>
<td align="center">Sample skewness (third moment) of values</td>
</tr>
<tr>
<td align="center">kurt</td>
<td align="center">Sample kurtosis (fourth moment) of values</td>
</tr>
<tr>
<td align="center">cumsum</td>
<td align="center">Cumulative sum of values</td>
</tr>
<tr>
<td align="center">cummin, cummax</td>
<td align="center">Cumulative minimum or maximum of values, respectively</td>
</tr>
<tr>
<td align="center">cumprod</td>
<td align="center">Cumulative product of values</td>
</tr>
<tr>
<td align="center">diff</td>
<td align="center">Compute first arithmetic difference (useful for time series)</td>
</tr>
<tr>
<td align="center">pct_change</td>
<td align="center">Compute percent changes</td>
</tr>
</tbody>
</table>
<h4 id="_12">相关性和方差</h4>
<p>一些汇总统计，如相关和方差，是从成对的参数程程。 让我们考虑一些来自Yahoo的股票价格和数量DataFrame! 使用附加的pandas-datareader包，</p>
<p>暂略</p>
<h4 id="_13">唯一值、值计数以及成员资格</h4>
<p>还有一类方法可以从一维Series的值中抽取信息。以下面这个Series为例：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="n">uniques</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="n">uniques</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>

<span class="n">obj</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> 
<span class="n">a</span>    <span class="mi">3</span>
<span class="n">c</span>    <span class="mi">3</span>
<span class="n">b</span>    <span class="mi">2</span>
<span class="n">d</span>    <span class="mi">1</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">pd</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> 
<span class="n">c</span>    <span class="mi">3</span>
<span class="n">d</span>    <span class="mi">1</span>
<span class="n">b</span>    <span class="mi">2</span>
<span class="n">a</span>    <span class="mi">3</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">obj</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="n">c</span>
<span class="mi">1</span>    <span class="n">a</span>
<span class="mi">2</span>    <span class="n">d</span>
<span class="mi">3</span>    <span class="n">a</span>
<span class="mi">4</span>    <span class="n">a</span>
<span class="mi">5</span>    <span class="n">b</span>
<span class="mi">6</span>    <span class="n">b</span>
<span class="mi">7</span>    <span class="n">c</span>
<span class="mi">8</span>    <span class="n">c</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="n">mask</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="n">mask</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> 
<span class="mi">0</span>     <span class="bp">True</span>
<span class="mi">1</span>    <span class="bp">False</span>
<span class="mi">2</span>    <span class="bp">False</span>
<span class="mi">3</span>    <span class="bp">False</span>
<span class="mi">4</span>    <span class="bp">False</span>
<span class="mi">5</span>     <span class="bp">True</span>
<span class="mi">6</span>     <span class="bp">True</span>
<span class="mi">7</span>     <span class="bp">True</span>
<span class="mi">8</span>     <span class="bp">True</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>

<span class="n">obj</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="n">c</span>
<span class="mi">5</span>    <span class="n">b</span>
<span class="mi">6</span>    <span class="n">b</span>
<span class="mi">7</span>    <span class="n">c</span>
<span class="mi">8</span>    <span class="n">c</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="n">to_match</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>

<span class="n">unique_vals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>

<span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">unique_vals</span><span class="p">)</span><span class="o">.</span><span class="n">get_indexer</span><span class="p">(</span><span class="n">to_match</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Qu1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;Qu2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;Qu3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>

<span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">20</span><span class="p">]:</span> 
   <span class="n">Qu1</span>  <span class="n">Qu2</span>  <span class="n">Qu3</span>
<span class="mi">0</span>    <span class="mi">1</span>    <span class="mi">2</span>    <span class="mi">1</span>
<span class="mi">1</span>    <span class="mi">3</span>    <span class="mi">3</span>    <span class="mi">5</span>
<span class="mi">2</span>    <span class="mi">4</span>    <span class="mi">1</span>    <span class="mi">2</span>
<span class="mi">3</span>    <span class="mi">3</span>    <span class="mi">2</span>    <span class="mi">4</span>
<span class="mi">4</span>    <span class="mi">4</span>    <span class="mi">3</span>    <span class="mi">4</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">value_counts</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">result</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">22</span><span class="p">]:</span> 
   <span class="n">Qu1</span>  <span class="n">Qu2</span>  <span class="n">Qu3</span>
<span class="mi">1</span>  <span class="mf">1.0</span>  <span class="mf">1.0</span>  <span class="mf">1.0</span>
<span class="mi">2</span>  <span class="mf">0.0</span>  <span class="mf">2.0</span>  <span class="mf">1.0</span>
<span class="mi">3</span>  <span class="mf">2.0</span>  <span class="mf">2.0</span>  <span class="mf">0.0</span>
<span class="mi">4</span>  <span class="mf">2.0</span>  <span class="mf">0.0</span>  <span class="mf">2.0</span>
<span class="mi">5</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">1.0</span>
</pre></div>
</td></tr></table>

<table>
<thead>
<tr>
<th align="center">Method</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">isin</td>
<td align="center">Compute boolean array indicating whether each Series value is contained in the passed sequence ofvalues</td>
</tr>
<tr>
<td align="center">match</td>
<td align="center">Compute integer indices for each value in an array into another array of distinct values; helpful for data</td>
</tr>
<tr>
<td align="center">alignment and join-type operations</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">unique</td>
<td align="center">Compute array of unique values in a Series, returned in the order observed</td>
</tr>
<tr>
<td align="center">value_counts</td>
<td align="center">Return a Series containing unique values as its index and frequencies as its values, ordered count in</td>
</tr>
<tr>
<td align="center">descending order</td>
<td align="center"></td>
</tr>
</tbody>
</table>
<h2 id="_14">数据清洗和准备</h2>
<p>在进行数据分析和建模的过程中，需要花费大量的时间(80％或更多)在数据准备上：加载，清理，转换和重新排列。有时候数据存储在文件或数据库中的方式不适合特定任务的格式。</p>
<p>在本章中，我将讨论缺失数据，重复数据，字符串操作，和其他一些分析数据转换。在下一章中，我将重点放在组合上，并以各种方式重新排列数据集。</p>
<h3 id="_15">处理缺失数据</h3>
<p>数值用浮点数NaN (Not a Number)表示缺失。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">string_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;aardvark&#39;</span><span class="p">,</span> <span class="s1">&#39;artichoke&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;avocado&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">string_data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> 
<span class="mi">0</span>     <span class="n">aardvark</span>
<span class="mi">1</span>    <span class="n">artichoke</span>
<span class="mi">2</span>          <span class="n">NaN</span>
<span class="mi">3</span>      <span class="n">avocado</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">string_data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="bp">False</span>
<span class="mi">1</span>    <span class="bp">False</span>
<span class="mi">2</span>     <span class="bp">True</span>
<span class="mi">3</span>    <span class="bp">False</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">string_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">string_data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span> 
<span class="mi">0</span>     <span class="bp">True</span>
<span class="mi">1</span>    <span class="bp">False</span>
<span class="mi">2</span>     <span class="bp">True</span>
<span class="mi">3</span>    <span class="bp">False</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>

<span class="n">NA相关的处理方法</span>
</pre></div>
</td></tr></table>

<p>数据缺失用NA(not available)表示， python内置的None也为NA。</p>
<table>
<thead>
<tr>
<th align="center">Argument</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">dropna</td>
<td align="center">Filter axis labels based on whether values for each label have missing data, with varying thresholds for how much missing data to tolerate.</td>
</tr>
<tr>
<td align="center">fillna</td>
<td align="center">Fill in missing data with some value or using an interpolation method such as 'ffill' or 'bfill' .</td>
</tr>
<tr>
<td align="center">isnull</td>
<td align="center">Return boolean values indicating which values are missing/NA.</td>
</tr>
<tr>
<td align="center">notnull</td>
<td align="center">Negation of isnull .</td>
</tr>
</tbody>
</table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">nan</span> <span class="k">as</span> <span class="n">NA</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">NA</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="n">NA</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="mf">1.0</span>
<span class="mi">2</span>    <span class="mf">3.5</span>
<span class="mi">4</span>    <span class="mf">7.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="mf">1.0</span>
<span class="mi">2</span>    <span class="mf">3.5</span>
<span class="mi">4</span>    <span class="mf">7.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="n">NA</span><span class="p">,</span> <span class="n">NA</span><span class="p">],</span>
   <span class="o">....</span><span class="p">:</span> <span class="p">[</span><span class="n">NA</span><span class="p">,</span> <span class="n">NA</span><span class="p">,</span> <span class="n">NA</span><span class="p">],</span> <span class="p">[</span><span class="n">NA</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">cleaned</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> 
     <span class="mi">0</span>    <span class="mi">1</span>    <span class="mi">2</span>
<span class="mi">0</span>  <span class="mf">1.0</span>  <span class="mf">6.5</span>  <span class="mf">3.0</span>
<span class="mi">1</span>  <span class="mf">1.0</span>  <span class="n">NaN</span>  <span class="n">NaN</span>
<span class="mi">2</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="n">NaN</span>
<span class="mi">3</span>  <span class="n">NaN</span>  <span class="mf">6.5</span>  <span class="mf">3.0</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">cleaned</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> 
     <span class="mi">0</span>    <span class="mi">1</span>    <span class="mi">2</span>
<span class="mi">0</span>  <span class="mf">1.0</span>  <span class="mf">6.5</span>  <span class="mf">3.0</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> 
     <span class="mi">0</span>    <span class="mi">1</span>    <span class="mi">2</span>
<span class="mi">0</span>  <span class="mf">1.0</span>  <span class="mf">6.5</span>  <span class="mf">3.0</span>
<span class="mi">1</span>  <span class="mf">1.0</span>  <span class="n">NaN</span>  <span class="n">NaN</span>
<span class="mi">3</span>  <span class="n">NaN</span>  <span class="mf">6.5</span>  <span class="mf">3.0</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">NA</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> 
     <span class="mi">0</span>    <span class="mi">1</span>    <span class="mi">2</span>   <span class="mi">4</span>
<span class="mi">0</span>  <span class="mf">1.0</span>  <span class="mf">6.5</span>  <span class="mf">3.0</span> <span class="n">NaN</span>
<span class="mi">1</span>  <span class="mf">1.0</span>  <span class="n">NaN</span>  <span class="n">NaN</span> <span class="n">NaN</span>
<span class="mi">2</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="n">NaN</span> <span class="n">NaN</span>
<span class="mi">3</span>  <span class="n">NaN</span>  <span class="mf">6.5</span>  <span class="mf">3.0</span> <span class="n">NaN</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">((</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">19</span><span class="p">]:</span> 
     <span class="mi">0</span>    <span class="mi">1</span>    <span class="mi">2</span>
<span class="mi">0</span>  <span class="mf">1.0</span>  <span class="mf">6.5</span>  <span class="mf">3.0</span>
<span class="mi">1</span>  <span class="mf">1.0</span>  <span class="n">NaN</span>  <span class="n">NaN</span>
<span class="mi">2</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="n">NaN</span>
<span class="mi">3</span>  <span class="n">NaN</span>  <span class="mf">6.5</span>  <span class="mf">3.0</span>
</pre></div>
</td></tr></table>

<p>how='all'要所有行都为NaN时才会删除。thresh参数可以指定NA的个数。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">NA</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">23</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">NA</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">24</span><span class="p">]:</span> <span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">24</span><span class="p">]:</span> 
          <span class="mi">0</span>         <span class="mi">1</span>         <span class="mi">2</span>
<span class="mi">0</span> <span class="o">-</span><span class="mf">0.843340</span>       <span class="n">NaN</span>       <span class="n">NaN</span>
<span class="mi">1</span> <span class="o">-</span><span class="mf">1.305941</span>       <span class="n">NaN</span>       <span class="n">NaN</span>
<span class="mi">2</span>  <span class="mf">1.026378</span>       <span class="n">NaN</span>  <span class="mf">2.176567</span>
<span class="mi">3</span>  <span class="mf">0.048885</span>       <span class="n">NaN</span>  <span class="mf">0.012649</span>
<span class="mi">4</span>  <span class="mf">0.591212</span> <span class="o">-</span><span class="mf">0.739625</span>  <span class="mf">1.017533</span>
<span class="mi">5</span>  <span class="mf">0.633873</span> <span class="o">-</span><span class="mf">0.124162</span> <span class="o">-</span><span class="mf">0.823495</span>
<span class="mi">6</span> <span class="o">-</span><span class="mf">1.537827</span>  <span class="mf">0.802565</span>  <span class="mf">0.359058</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">25</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">25</span><span class="p">]:</span> 
          <span class="mi">0</span>         <span class="mi">1</span>         <span class="mi">2</span>
<span class="mi">4</span>  <span class="mf">0.591212</span> <span class="o">-</span><span class="mf">0.739625</span>  <span class="mf">1.017533</span>
<span class="mi">5</span>  <span class="mf">0.633873</span> <span class="o">-</span><span class="mf">0.124162</span> <span class="o">-</span><span class="mf">0.823495</span>
<span class="mi">6</span> <span class="o">-</span><span class="mf">1.537827</span>  <span class="mf">0.802565</span>  <span class="mf">0.359058</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">26</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">26</span><span class="p">]:</span> 
          <span class="mi">0</span>         <span class="mi">1</span>         <span class="mi">2</span>
<span class="mi">2</span>  <span class="mf">1.026378</span>       <span class="n">NaN</span>  <span class="mf">2.176567</span>
<span class="mi">3</span>  <span class="mf">0.048885</span>       <span class="n">NaN</span>  <span class="mf">0.012649</span>
<span class="mi">4</span>  <span class="mf">0.591212</span> <span class="o">-</span><span class="mf">0.739625</span>  <span class="mf">1.017533</span>
<span class="mi">5</span>  <span class="mf">0.633873</span> <span class="o">-</span><span class="mf">0.124162</span> <span class="o">-</span><span class="mf">0.823495</span>
<span class="mi">6</span> <span class="o">-</span><span class="mf">1.537827</span>  <span class="mf">0.802565</span>  <span class="mf">0.359058</span>
</pre></div>
</td></tr></table>

<p>fillna用来对缺失值进行填充。可以针对列进行填充，用上一行的值填充，用平均值填充等。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">27</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">27</span><span class="p">]:</span> 
          <span class="mi">0</span>         <span class="mi">1</span>         <span class="mi">2</span>
<span class="mi">0</span> <span class="o">-</span><span class="mf">0.843340</span>  <span class="mf">0.000000</span>  <span class="mf">0.000000</span>
<span class="mi">1</span> <span class="o">-</span><span class="mf">1.305941</span>  <span class="mf">0.000000</span>  <span class="mf">0.000000</span>
<span class="mi">2</span>  <span class="mf">1.026378</span>  <span class="mf">0.000000</span>  <span class="mf">2.176567</span>
<span class="mi">3</span>  <span class="mf">0.048885</span>  <span class="mf">0.000000</span>  <span class="mf">0.012649</span>
<span class="mi">4</span>  <span class="mf">0.591212</span> <span class="o">-</span><span class="mf">0.739625</span>  <span class="mf">1.017533</span>
<span class="mi">5</span>  <span class="mf">0.633873</span> <span class="o">-</span><span class="mf">0.124162</span> <span class="o">-</span><span class="mf">0.823495</span>
<span class="mi">6</span> <span class="o">-</span><span class="mf">1.537827</span>  <span class="mf">0.802565</span>  <span class="mf">0.359058</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">28</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">28</span><span class="p">]:</span> 
          <span class="mi">0</span>         <span class="mi">1</span>         <span class="mi">2</span>
<span class="mi">0</span> <span class="o">-</span><span class="mf">0.843340</span>  <span class="mf">0.500000</span>  <span class="mf">0.000000</span>
<span class="mi">1</span> <span class="o">-</span><span class="mf">1.305941</span>  <span class="mf">0.500000</span>  <span class="mf">0.000000</span>
<span class="mi">2</span>  <span class="mf">1.026378</span>  <span class="mf">0.500000</span>  <span class="mf">2.176567</span>
<span class="mi">3</span>  <span class="mf">0.048885</span>  <span class="mf">0.500000</span>  <span class="mf">0.012649</span>
<span class="mi">4</span>  <span class="mf">0.591212</span> <span class="o">-</span><span class="mf">0.739625</span>  <span class="mf">1.017533</span>
<span class="mi">5</span>  <span class="mf">0.633873</span> <span class="o">-</span><span class="mf">0.124162</span> <span class="o">-</span><span class="mf">0.823495</span>
<span class="mi">6</span> <span class="o">-</span><span class="mf">1.537827</span>  <span class="mf">0.802565</span>  <span class="mf">0.359058</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">29</span><span class="p">]:</span> <span class="n">_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">30</span><span class="p">]:</span> <span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">30</span><span class="p">]:</span> 
          <span class="mi">0</span>         <span class="mi">1</span>         <span class="mi">2</span>
<span class="mi">0</span> <span class="o">-</span><span class="mf">0.843340</span>  <span class="mf">0.000000</span>  <span class="mf">0.000000</span>
<span class="mi">1</span> <span class="o">-</span><span class="mf">1.305941</span>  <span class="mf">0.000000</span>  <span class="mf">0.000000</span>
<span class="mi">2</span>  <span class="mf">1.026378</span>  <span class="mf">0.000000</span>  <span class="mf">2.176567</span>
<span class="mi">3</span>  <span class="mf">0.048885</span>  <span class="mf">0.000000</span>  <span class="mf">0.012649</span>
<span class="mi">4</span>  <span class="mf">0.591212</span> <span class="o">-</span><span class="mf">0.739625</span>  <span class="mf">1.017533</span>
<span class="mi">5</span>  <span class="mf">0.633873</span> <span class="o">-</span><span class="mf">0.124162</span> <span class="o">-</span><span class="mf">0.823495</span>
<span class="mi">6</span> <span class="o">-</span><span class="mf">1.537827</span>  <span class="mf">0.802565</span>  <span class="mf">0.359058</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">31</span><span class="p">]:</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">32</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">NA</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">33</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">NA</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">34</span><span class="p">]:</span> <span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">34</span><span class="p">]:</span> 
          <span class="mi">0</span>         <span class="mi">1</span>         <span class="mi">2</span>
<span class="mi">0</span> <span class="o">-</span><span class="mf">0.081265</span> <span class="o">-</span><span class="mf">0.820770</span> <span class="o">-</span><span class="mf">0.746845</span>
<span class="mi">1</span>  <span class="mf">1.150648</span>  <span class="mf">0.977842</span>  <span class="mf">0.861825</span>
<span class="mi">2</span>  <span class="mf">1.823679</span>       <span class="n">NaN</span>  <span class="mf">1.272047</span>
<span class="mi">3</span>  <span class="mf">0.293133</span>       <span class="n">NaN</span>  <span class="mf">0.273399</span>
<span class="mi">4</span>  <span class="mf">0.235116</span>       <span class="n">NaN</span>       <span class="n">NaN</span>
<span class="mi">5</span>  <span class="mf">1.365186</span>       <span class="n">NaN</span>       <span class="n">NaN</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">35</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">35</span><span class="p">]:</span> 
          <span class="mi">0</span>         <span class="mi">1</span>         <span class="mi">2</span>
<span class="mi">0</span> <span class="o">-</span><span class="mf">0.081265</span> <span class="o">-</span><span class="mf">0.820770</span> <span class="o">-</span><span class="mf">0.746845</span>
<span class="mi">1</span>  <span class="mf">1.150648</span>  <span class="mf">0.977842</span>  <span class="mf">0.861825</span>
<span class="mi">2</span>  <span class="mf">1.823679</span>  <span class="mf">0.977842</span>  <span class="mf">1.272047</span>
<span class="mi">3</span>  <span class="mf">0.293133</span>  <span class="mf">0.977842</span>  <span class="mf">0.273399</span>
<span class="mi">4</span>  <span class="mf">0.235116</span>  <span class="mf">0.977842</span>  <span class="mf">0.273399</span>
<span class="mi">5</span>  <span class="mf">1.365186</span>  <span class="mf">0.977842</span>  <span class="mf">0.273399</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">36</span><span class="p">]:</span> <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">36</span><span class="p">]:</span> 
          <span class="mi">0</span>         <span class="mi">1</span>         <span class="mi">2</span>
<span class="mi">0</span> <span class="o">-</span><span class="mf">0.081265</span> <span class="o">-</span><span class="mf">0.820770</span> <span class="o">-</span><span class="mf">0.746845</span>
<span class="mi">1</span>  <span class="mf">1.150648</span>  <span class="mf">0.977842</span>  <span class="mf">0.861825</span>
<span class="mi">2</span>  <span class="mf">1.823679</span>  <span class="mf">0.977842</span>  <span class="mf">1.272047</span>
<span class="mi">3</span>  <span class="mf">0.293133</span>  <span class="mf">0.977842</span>  <span class="mf">0.273399</span>
<span class="mi">4</span>  <span class="mf">0.235116</span>       <span class="n">NaN</span>  <span class="mf">0.273399</span>
<span class="mi">5</span>  <span class="mf">1.365186</span>       <span class="n">NaN</span>  <span class="mf">0.273399</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">37</span><span class="p">]:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="n">NA</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="n">NA</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">38</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">38</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="mf">1.000000</span>
<span class="mi">1</span>    <span class="mf">3.833333</span>
<span class="mi">2</span>    <span class="mf">3.500000</span>
<span class="mi">3</span>    <span class="mf">3.833333</span>
<span class="mi">4</span>    <span class="mf">7.000000</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</td></tr></table>

<table>
<thead>
<tr>
<th align="center">Argument</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">value</td>
<td align="center">Scalar value or dict-like object to use to fill missing values</td>
</tr>
<tr>
<td align="center">method</td>
<td align="center">Interpolation; by default 'ffill' if function called with no other arguments</td>
</tr>
<tr>
<td align="center">axis</td>
<td align="center">Axis to fill on; default axis=0</td>
</tr>
<tr>
<td align="center">inplace</td>
<td align="center">Modify the calling object without producing a copy</td>
</tr>
<tr>
<td align="center">limit</td>
<td align="center">For forward and backward filling, maximum number of consecutive periods to fill</td>
</tr>
</tbody>
</table>
<h3 id="_16">数据转换</h3>
<h4 id="_17">去重</h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">39</span><span class="p">]:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;k1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;two&#39;</span><span class="p">],</span>
   <span class="o">....</span><span class="p">:</span> <span class="s1">&#39;k2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">40</span><span class="p">]:</span> <span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">40</span><span class="p">]:</span> 
    <span class="n">k1</span>  <span class="n">k2</span>
<span class="mi">0</span>  <span class="n">one</span>   <span class="mi">1</span>
<span class="mi">1</span>  <span class="n">two</span>   <span class="mi">1</span>
<span class="mi">2</span>  <span class="n">one</span>   <span class="mi">2</span>
<span class="mi">3</span>  <span class="n">two</span>   <span class="mi">3</span>
<span class="mi">4</span>  <span class="n">one</span>   <span class="mi">3</span>
<span class="mi">5</span>  <span class="n">two</span>   <span class="mi">4</span>
<span class="mi">6</span>  <span class="n">two</span>   <span class="mi">4</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">41</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">41</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="bp">False</span>
<span class="mi">1</span>    <span class="bp">False</span>
<span class="mi">2</span>    <span class="bp">False</span>
<span class="mi">3</span>    <span class="bp">False</span>
<span class="mi">4</span>    <span class="bp">False</span>
<span class="mi">5</span>    <span class="bp">False</span>
<span class="mi">6</span>     <span class="bp">True</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">42</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">42</span><span class="p">]:</span> 
    <span class="n">k1</span>  <span class="n">k2</span>
<span class="mi">0</span>  <span class="n">one</span>   <span class="mi">1</span>
<span class="mi">1</span>  <span class="n">two</span>   <span class="mi">1</span>
<span class="mi">2</span>  <span class="n">one</span>   <span class="mi">2</span>
<span class="mi">3</span>  <span class="n">two</span>   <span class="mi">3</span>
<span class="mi">4</span>  <span class="n">one</span>   <span class="mi">3</span>
<span class="mi">5</span>  <span class="n">two</span>   <span class="mi">4</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">43</span><span class="p">]:</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">44</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">([</span><span class="s1">&#39;k1&#39;</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">44</span><span class="p">]:</span> 
    <span class="n">k1</span>  <span class="n">k2</span>  <span class="n">v1</span>
<span class="mi">0</span>  <span class="n">one</span>   <span class="mi">1</span>   <span class="mi">0</span>
<span class="mi">1</span>  <span class="n">two</span>   <span class="mi">1</span>   <span class="mi">1</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">45</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">([</span><span class="s1">&#39;k1&#39;</span><span class="p">,</span> <span class="s1">&#39;k2&#39;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">45</span><span class="p">]:</span> 
    <span class="n">k1</span>  <span class="n">k2</span>  <span class="n">v1</span>
<span class="mi">0</span>  <span class="n">one</span>   <span class="mi">1</span>   <span class="mi">0</span>
<span class="mi">1</span>  <span class="n">two</span>   <span class="mi">1</span>   <span class="mi">1</span>
<span class="mi">2</span>  <span class="n">one</span>   <span class="mi">2</span>   <span class="mi">2</span>
<span class="mi">3</span>  <span class="n">two</span>   <span class="mi">3</span>   <span class="mi">3</span>
<span class="mi">4</span>  <span class="n">one</span>   <span class="mi">3</span>   <span class="mi">4</span>
<span class="mi">6</span>  <span class="n">two</span>   <span class="mi">4</span>   <span class="mi">6</span>
</pre></div>
</td></tr></table>

<h4 id="map">使用函数或者映射(map)转换数据</h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;food&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;bacon&#39;</span><span class="p">,</span> <span class="s1">&#39;pulled pork&#39;</span><span class="p">,</span> <span class="s1">&#39;bacon&#39;</span><span class="p">,</span>
<span class="s1">&#39;Pastrami&#39;</span><span class="p">,</span> <span class="s1">&#39;corned beef&#39;</span><span class="p">,</span> <span class="s1">&#39;Bacon&#39;</span><span class="p">,</span>
<span class="s1">&#39;pastrami&#39;</span><span class="p">,</span> <span class="s1">&#39;honey ham&#39;</span><span class="p">,</span> <span class="s1">&#39;nova lox&#39;</span><span class="p">],</span>
<span class="s1">&#39;ounces&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>

<span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> 
          <span class="n">food</span>  <span class="n">ounces</span>
<span class="mi">0</span>        <span class="n">bacon</span>     <span class="mf">4.0</span>
<span class="mi">1</span>  <span class="n">pulled</span> <span class="n">pork</span>     <span class="mf">3.0</span>
<span class="mi">2</span>        <span class="n">bacon</span>    <span class="mf">12.0</span>
<span class="mi">3</span>     <span class="n">Pastrami</span>     <span class="mf">6.0</span>
<span class="mi">4</span>  <span class="n">corned</span> <span class="n">beef</span>     <span class="mf">7.5</span>
<span class="mi">5</span>        <span class="n">Bacon</span>     <span class="mf">8.0</span>
<span class="mi">6</span>     <span class="n">pastrami</span>     <span class="mf">3.0</span>
<span class="mi">7</span>    <span class="n">honey</span> <span class="n">ham</span>     <span class="mf">5.0</span>
<span class="mi">8</span>     <span class="n">nova</span> <span class="n">lox</span>     <span class="mf">6.0</span>

<span class="n">meat_to_animal</span> <span class="o">=</span> <span class="p">{</span>
<span class="s1">&#39;bacon&#39;</span><span class="p">:</span> <span class="s1">&#39;pig&#39;</span><span class="p">,</span>
<span class="s1">&#39;pulled pork&#39;</span><span class="p">:</span> <span class="s1">&#39;pig&#39;</span><span class="p">,</span>
<span class="s1">&#39;pastrami&#39;</span><span class="p">:</span> <span class="s1">&#39;cow&#39;</span><span class="p">,</span>
<span class="s1">&#39;corned beef&#39;</span><span class="p">:</span> <span class="s1">&#39;cow&#39;</span><span class="p">,</span>
<span class="s1">&#39;honey ham&#39;</span><span class="p">:</span> <span class="s1">&#39;pig&#39;</span><span class="p">,</span>
<span class="s1">&#39;nova lox&#39;</span><span class="p">:</span> <span class="s1">&#39;salmon&#39;</span>
<span class="p">}</span>

<span class="n">lowercased</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;food&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

<span class="n">lowercased</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span> 
<span class="mi">0</span>          <span class="n">bacon</span>
<span class="mi">1</span>    <span class="n">pulled</span> <span class="n">pork</span>
<span class="mi">2</span>          <span class="n">bacon</span>
<span class="mi">3</span>       <span class="n">pastrami</span>
<span class="mi">4</span>    <span class="n">corned</span> <span class="n">beef</span>
<span class="mi">5</span>          <span class="n">bacon</span>
<span class="mi">6</span>       <span class="n">pastrami</span>
<span class="mi">7</span>      <span class="n">honey</span> <span class="n">ham</span>
<span class="mi">8</span>       <span class="n">nova</span> <span class="n">lox</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">food</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;animal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lowercased</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">meat_to_animal</span><span class="p">)</span>

<span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> 
          <span class="n">food</span>  <span class="n">ounces</span>  <span class="n">animal</span>
<span class="mi">0</span>        <span class="n">bacon</span>     <span class="mf">4.0</span>     <span class="n">pig</span>
<span class="mi">1</span>  <span class="n">pulled</span> <span class="n">pork</span>     <span class="mf">3.0</span>     <span class="n">pig</span>
<span class="mi">2</span>        <span class="n">bacon</span>    <span class="mf">12.0</span>     <span class="n">pig</span>
<span class="mi">3</span>     <span class="n">Pastrami</span>     <span class="mf">6.0</span>     <span class="n">cow</span>
<span class="mi">4</span>  <span class="n">corned</span> <span class="n">beef</span>     <span class="mf">7.5</span>     <span class="n">cow</span>
<span class="mi">5</span>        <span class="n">Bacon</span>     <span class="mf">8.0</span>     <span class="n">pig</span>
<span class="mi">6</span>     <span class="n">pastrami</span>     <span class="mf">3.0</span>     <span class="n">cow</span>
<span class="mi">7</span>    <span class="n">honey</span> <span class="n">ham</span>     <span class="mf">5.0</span>     <span class="n">pig</span>
<span class="mi">8</span>     <span class="n">nova</span> <span class="n">lox</span>     <span class="mf">6.0</span>  <span class="n">salmon</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;food&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">meat_to_animal</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> 
<span class="mi">0</span>       <span class="n">pig</span>
<span class="mi">1</span>       <span class="n">pig</span>
<span class="mi">2</span>       <span class="n">pig</span>
<span class="mi">3</span>       <span class="n">cow</span>
<span class="mi">4</span>       <span class="n">cow</span>
<span class="mi">5</span>       <span class="n">pig</span>
<span class="mi">6</span>       <span class="n">cow</span>
<span class="mi">7</span>       <span class="n">pig</span>
<span class="mi">8</span>    <span class="n">salmon</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">food</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</td></tr></table>

<h4 id="_18">替换</h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">999.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="o">-</span><span class="mf">999.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1000.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> 
<span class="mi">0</span>       <span class="mf">1.0</span>
<span class="mi">1</span>    <span class="o">-</span><span class="mf">999.0</span>
<span class="mi">2</span>       <span class="mf">2.0</span>
<span class="mi">3</span>    <span class="o">-</span><span class="mf">999.0</span>
<span class="mi">4</span>   <span class="o">-</span><span class="mf">1000.0</span>
<span class="mi">5</span>       <span class="mf">3.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> 
<span class="mi">0</span>       <span class="mf">1.0</span>
<span class="mi">1</span>       <span class="n">NaN</span>
<span class="mi">2</span>       <span class="mf">2.0</span>
<span class="mi">3</span>       <span class="n">NaN</span>
<span class="mi">4</span>   <span class="o">-</span><span class="mf">1000.0</span>
<span class="mi">5</span>       <span class="mf">3.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="mf">1.0</span>
<span class="mi">1</span>    <span class="n">NaN</span>
<span class="mi">2</span>    <span class="mf">2.0</span>
<span class="mi">3</span>    <span class="n">NaN</span>
<span class="mi">4</span>    <span class="n">NaN</span>
<span class="mi">5</span>    <span class="mf">3.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="mf">1.0</span>
<span class="mi">1</span>    <span class="n">NaN</span>
<span class="mi">2</span>    <span class="mf">2.0</span>
<span class="mi">3</span>    <span class="n">NaN</span>
<span class="mi">4</span>    <span class="mf">0.0</span>
<span class="mi">5</span>    <span class="mf">3.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="o">-</span><span class="mi">999</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="mf">1.0</span>
<span class="mi">1</span>    <span class="n">NaN</span>
<span class="mi">2</span>    <span class="mf">2.0</span>
<span class="mi">3</span>    <span class="n">NaN</span>
<span class="mi">4</span>    <span class="mf">0.0</span>
<span class="mi">5</span>    <span class="mf">3.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</td></tr></table>

<h4 id="_19">索引和列名修改</h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>



<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
   <span class="o">....</span><span class="p">:</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Colorado&#39;</span><span class="p">,</span> <span class="s1">&#39;New York&#39;</span><span class="p">],</span>
   <span class="o">....</span><span class="p">:</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">,</span> <span class="s1">&#39;four&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> 
          <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">Ohio</span>        <span class="mi">0</span>    <span class="mi">1</span>      <span class="mi">2</span>     <span class="mi">3</span>
<span class="n">Colorado</span>    <span class="mi">4</span>    <span class="mi">5</span>      <span class="mi">6</span>     <span class="mi">7</span>
<span class="n">New</span> <span class="n">York</span>    <span class="mi">8</span>    <span class="mi">9</span>     <span class="mi">10</span>    <span class="mi">11</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> 
          <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">Ohio</span>        <span class="mi">0</span>    <span class="mi">1</span>      <span class="mi">2</span>     <span class="mi">3</span>
<span class="n">Colorado</span>   <span class="mi">40</span>    <span class="mi">5</span>      <span class="mi">6</span>     <span class="mi">7</span>
<span class="n">New</span> <span class="n">York</span>    <span class="mi">8</span>    <span class="mi">9</span>     <span class="mi">10</span>    <span class="mi">11</span>


<span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="n">transform</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">Index</span><span class="p">([</span><span class="s1">&#39;OHIO&#39;</span><span class="p">,</span> <span class="s1">&#39;COLO&#39;</span><span class="p">,</span> <span class="s1">&#39;NEW &#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> 
          <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">Ohio</span>        <span class="mi">0</span>    <span class="mi">1</span>      <span class="mi">2</span>     <span class="mi">3</span>
<span class="n">Colorado</span>    <span class="mi">4</span>    <span class="mi">5</span>      <span class="mi">6</span>     <span class="mi">7</span>
<span class="n">New</span> <span class="n">York</span>    <span class="mi">8</span>    <span class="mi">9</span>     <span class="mi">10</span>    <span class="mi">11</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> 
      <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">OHIO</span>    <span class="mi">0</span>    <span class="mi">1</span>      <span class="mi">2</span>     <span class="mi">3</span>
<span class="n">COLO</span>    <span class="mi">4</span>    <span class="mi">5</span>      <span class="mi">6</span>     <span class="mi">7</span>
<span class="n">NEW</span>     <span class="mi">8</span>    <span class="mi">9</span>     <span class="mi">10</span>    <span class="mi">11</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">upper</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> 
      <span class="n">ONE</span>  <span class="n">TWO</span>  <span class="n">THREE</span>  <span class="n">FOUR</span>
<span class="n">Ohio</span>    <span class="mi">0</span>    <span class="mi">1</span>      <span class="mi">2</span>     <span class="mi">3</span>
<span class="n">Colo</span>    <span class="mi">4</span>    <span class="mi">5</span>      <span class="mi">6</span>     <span class="mi">7</span>
<span class="n">New</span>     <span class="mi">8</span>    <span class="mi">9</span>     <span class="mi">10</span>    <span class="mi">11</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;OHIO&#39;</span><span class="p">:</span> <span class="s1">&#39;INDIANA&#39;</span><span class="p">},</span> <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;three&#39;</span><span class="p">:</span> <span class="s1">&#39;peekaboo&#39;</span><span class="p">})</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> 
         <span class="n">one</span>  <span class="n">two</span>  <span class="n">peekaboo</span>  <span class="n">four</span>
<span class="n">INDIANA</span>    <span class="mi">0</span>    <span class="mi">1</span>         <span class="mi">2</span>     <span class="mi">3</span>
<span class="n">COLO</span>       <span class="mi">4</span>    <span class="mi">5</span>         <span class="mi">6</span>     <span class="mi">7</span>
<span class="n">NEW</span>        <span class="mi">8</span>    <span class="mi">9</span>        <span class="mi">10</span>    <span class="mi">11</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;OHIO&#39;</span><span class="p">:</span> <span class="s1">&#39;INDIANA&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">20</span><span class="p">]:</span> 
         <span class="n">one</span>  <span class="n">two</span>  <span class="n">three</span>  <span class="n">four</span>
<span class="n">INDIANA</span>    <span class="mi">0</span>    <span class="mi">1</span>      <span class="mi">2</span>     <span class="mi">3</span>
<span class="n">COLO</span>       <span class="mi">4</span>    <span class="mi">5</span>      <span class="mi">6</span>     <span class="mi">7</span>
<span class="n">NEW</span>        <span class="mi">8</span>    <span class="mi">9</span>     <span class="mi">10</span>    <span class="mi">11</span>
</pre></div>
</td></tr></table>

<h3 id="_20">离散化和面元划分</h3>
<p>以下暂略</p>
<h4 id="_21">字符串处理</h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Dave&#39;</span><span class="p">:</span> <span class="s1">&#39;dave@google.com&#39;</span><span class="p">,</span> <span class="s1">&#39;Steve&#39;</span><span class="p">:</span> <span class="s1">&#39;steve@gmail.com&#39;</span><span class="p">,</span>
   <span class="o">...</span><span class="p">:</span> <span class="s1">&#39;Rob&#39;</span><span class="p">:</span> <span class="s1">&#39;rob@gmail.com&#39;</span><span class="p">,</span> <span class="s1">&#39;Wes&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span> 
<span class="n">Dave</span>     <span class="n">dave</span><span class="nd">@google.com</span>
<span class="n">Rob</span>        <span class="n">rob</span><span class="nd">@gmail.com</span>
<span class="n">Steve</span>    <span class="n">steve</span><span class="nd">@gmail.com</span>
<span class="n">Wes</span>                  <span class="n">NaN</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> 
<span class="n">Dave</span>     <span class="bp">False</span>
<span class="n">Rob</span>      <span class="bp">False</span>
<span class="n">Steve</span>    <span class="bp">False</span>
<span class="n">Wes</span>       <span class="bp">True</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;gmail&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> 
<span class="n">Dave</span>     <span class="bp">False</span>
<span class="n">Rob</span>       <span class="bp">True</span>
<span class="n">Steve</span>     <span class="bp">True</span>
<span class="n">Wes</span>        <span class="n">NaN</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="n">pattern</span> <span class="o">=</span> <span class="s1">&#39;([A-Z0-9._%+-]+)@([A-Z0-9.-]+)</span><span class="se">\\</span><span class="s1">.([A-Z]{2,4})&#39;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
<span class="o">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">13</span><span class="o">-</span><span class="mi">085</span><span class="n">c16e4dbfe</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">data</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>

<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;re&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">re</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> 
<span class="n">Dave</span>     <span class="p">[(</span><span class="n">dave</span><span class="p">,</span> <span class="n">google</span><span class="p">,</span> <span class="n">com</span><span class="p">)]</span>
<span class="n">Rob</span>        <span class="p">[(</span><span class="n">rob</span><span class="p">,</span> <span class="n">gmail</span><span class="p">,</span> <span class="n">com</span><span class="p">)]</span>
<span class="n">Steve</span>    <span class="p">[(</span><span class="n">steve</span><span class="p">,</span> <span class="n">gmail</span><span class="p">,</span> <span class="n">com</span><span class="p">)]</span>
<span class="n">Wes</span>                        <span class="n">NaN</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">matches</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">matches</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> 
<span class="n">Dave</span>     <span class="bp">True</span>
<span class="n">Rob</span>      <span class="bp">True</span>
<span class="n">Steve</span>    <span class="bp">True</span>
<span class="n">Wes</span>       <span class="n">NaN</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">matches</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> 
<span class="n">Dave</span>    <span class="n">NaN</span>
<span class="n">Rob</span>     <span class="n">NaN</span>
<span class="n">Steve</span>   <span class="n">NaN</span>
<span class="n">Wes</span>     <span class="n">NaN</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="n">matches</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">19</span><span class="p">]:</span> 
<span class="n">Dave</span>    <span class="n">NaN</span>
<span class="n">Rob</span>     <span class="n">NaN</span>
<span class="n">Steve</span>   <span class="n">NaN</span>
<span class="n">Wes</span>     <span class="n">NaN</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">20</span><span class="p">]:</span> 
<span class="n">Dave</span>     <span class="n">dave</span><span class="err">@</span>
<span class="n">Rob</span>      <span class="n">rob</span><span class="nd">@g</span>
<span class="n">Steve</span>    <span class="n">steve</span>
<span class="n">Wes</span>        <span class="n">NaN</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</td></tr></table>

<table>
<thead>
<tr>
<th align="center">Method</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">cat</td>
<td align="center">Concatenate strings element-wise with optional delimiter</td>
</tr>
<tr>
<td align="center">contains</td>
<td align="center">Return boolean array if each string contains pattern/regex</td>
</tr>
<tr>
<td align="center">count</td>
<td align="center">Count occurrences of pattern</td>
</tr>
<tr>
<td align="center">extract</td>
<td align="center">Use a regular expression with groups to extract one or more strings from a Series of strings; the result will be a DataFrame with one column per group</td>
</tr>
<tr>
<td align="center">endswith</td>
<td align="center">Equivalent to x.endswith(pattern) for each element</td>
</tr>
<tr>
<td align="center">startswith</td>
<td align="center">Equivalent to x.startswith(pattern) for each element</td>
</tr>
<tr>
<td align="center">findall</td>
<td align="center">Compute list of all occurrences of pattern/regex for each string</td>
</tr>
<tr>
<td align="center">get</td>
<td align="center">Index into each element (retrieve i-th element)</td>
</tr>
<tr>
<td align="center">isalnum</td>
<td align="center">Equivalent to built-in str.alnum</td>
</tr>
<tr>
<td align="center">isalpha</td>
<td align="center">Equivalent to built-in str.isalpha</td>
</tr>
<tr>
<td align="center">isdecimal</td>
<td align="center">Equivalent to built-in str.isdecimal</td>
</tr>
<tr>
<td align="center">isdigit</td>
<td align="center">Equivalent to built-in str.isdigit</td>
</tr>
<tr>
<td align="center">islower</td>
<td align="center">Equivalent to built-in str.islower</td>
</tr>
<tr>
<td align="center">isnumeric</td>
<td align="center">Equivalent to built-in str.isnumeric</td>
</tr>
<tr>
<td align="center">isupper</td>
<td align="center">Equivalent to built-in str.isupper</td>
</tr>
<tr>
<td align="center">join</td>
<td align="center">Join strings in each element of the Series with passed separator</td>
</tr>
<tr>
<td align="center">len</td>
<td align="center">Compute length of each string</td>
</tr>
<tr>
<td align="center">lower, upper</td>
<td align="center">Convert cases; equivalent to x.lower() or x.upper() for each element</td>
</tr>
<tr>
<td align="center">match</td>
<td align="center">Use re.match with the passed regular expression on each element, returning matched groups as list</td>
</tr>
<tr>
<td align="center">pad</td>
<td align="center">Add whitespace to left, right, or both sides of strings</td>
</tr>
<tr>
<td align="center">center</td>
<td align="center">Equivalent to pad(side='both')</td>
</tr>
<tr>
<td align="center">repeat</td>
<td align="center">Duplicate values (e.g., s.str.repeat(3) is equivalent to x * 3 for each string)</td>
</tr>
<tr>
<td align="center">replace</td>
<td align="center">Replace occurrences of pattern/regex with some other string</td>
</tr>
<tr>
<td align="center">slice</td>
<td align="center">Slice each string in the Series</td>
</tr>
<tr>
<td align="center">split</td>
<td align="center">Split strings on delimiter or regular expression</td>
</tr>
<tr>
<td align="center">strip</td>
<td align="center">Trim whitespace from both sides, including newlines</td>
</tr>
<tr>
<td align="center">rstrip</td>
<td align="center">Trim whitespace on right side</td>
</tr>
<tr>
<td align="center">lstrip</td>
<td align="center">Trim whitespace on left side</td>
</tr>
</tbody>
</table>
<h2 id="_22">数据争夺：连接，合并，和重塑</h2>
<p>在许多应用程序中，数据可能分布在多个文件或数据库中，或者是以不易分析的形式。 本章重点介绍连接，合并，和重塑。</p>
<h3 id="_23">分层索引</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>

<span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> 
<span class="n">a</span>  <span class="mi">1</span>   <span class="o">-</span><span class="mf">1.111004</span>
   <span class="mi">2</span>   <span class="o">-</span><span class="mf">0.451764</span>
   <span class="mi">3</span>   <span class="o">-</span><span class="mf">0.501180</span>
<span class="n">b</span>  <span class="mi">1</span>    <span class="mf">1.007739</span>
   <span class="mi">3</span>    <span class="mf">0.407470</span>
<span class="n">c</span>  <span class="mi">1</span>   <span class="o">-</span><span class="mf">0.307985</span>
   <span class="mi">2</span>    <span class="mf">0.608742</span>
<span class="n">d</span>  <span class="mi">2</span>    <span class="mf">1.432663</span>
   <span class="mi">3</span>   <span class="o">-</span><span class="mf">1.660043</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> 
<span class="mi">1</span>    <span class="mf">1.007739</span>
<span class="mi">3</span>    <span class="mf">0.407470</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span> 
<span class="n">b</span>  <span class="mi">1</span>    <span class="mf">1.007739</span>
   <span class="mi">3</span>    <span class="mf">0.407470</span>
<span class="n">c</span>  <span class="mi">1</span>   <span class="o">-</span><span class="mf">0.307985</span>
   <span class="mi">2</span>    <span class="mf">0.608742</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span> 
<span class="n">b</span>  <span class="mi">1</span>    <span class="mf">1.007739</span>
   <span class="mi">3</span>    <span class="mf">0.407470</span>
<span class="n">d</span>  <span class="mi">2</span>    <span class="mf">1.432663</span>
   <span class="mi">3</span>   <span class="o">-</span><span class="mf">1.660043</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span> 
<span class="n">a</span>   <span class="o">-</span><span class="mf">0.451764</span>
<span class="n">c</span>    <span class="mf">0.608742</span>
<span class="n">d</span>    <span class="mf">1.432663</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">data</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> 
          <span class="mi">1</span>         <span class="mi">2</span>         <span class="mi">3</span>
<span class="n">a</span> <span class="o">-</span><span class="mf">1.111004</span> <span class="o">-</span><span class="mf">0.451764</span> <span class="o">-</span><span class="mf">0.501180</span>
<span class="n">b</span>  <span class="mf">1.007739</span>       <span class="n">NaN</span>  <span class="mf">0.407470</span>
<span class="n">c</span> <span class="o">-</span><span class="mf">0.307985</span>  <span class="mf">0.608742</span>       <span class="n">NaN</span>
<span class="n">d</span>       <span class="n">NaN</span>  <span class="mf">1.432663</span> <span class="o">-</span><span class="mf">1.660043</span>

<span class="n">data</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> 
<span class="n">a</span>  <span class="mi">1</span>   <span class="o">-</span><span class="mf">1.111004</span>
   <span class="mi">2</span>   <span class="o">-</span><span class="mf">0.451764</span>
   <span class="mi">3</span>   <span class="o">-</span><span class="mf">0.501180</span>
<span class="n">b</span>  <span class="mi">1</span>    <span class="mf">1.007739</span>
   <span class="mi">3</span>    <span class="mf">0.407470</span>
<span class="n">c</span>  <span class="mi">1</span>   <span class="o">-</span><span class="mf">0.307985</span>
   <span class="mi">2</span>    <span class="mf">0.608742</span>
<span class="n">d</span>  <span class="mi">2</span>    <span class="mf">1.432663</span>
   <span class="mi">3</span>   <span class="o">-</span><span class="mf">1.660043</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span><span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Colorado&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Green&#39;</span><span class="p">,</span> <span class="s1">&#39;Red&#39;</span><span class="p">,</span> <span class="s1">&#39;Green&#39;</span><span class="p">]])</span>

<span class="n">frame</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> 
     <span class="n">Ohio</span>     <span class="n">Colorado</span>
    <span class="n">Green</span> <span class="n">Red</span>    <span class="n">Green</span>
<span class="n">a</span> <span class="mi">1</span>     <span class="mi">0</span>   <span class="mi">1</span>        <span class="mi">2</span>
  <span class="mi">2</span>     <span class="mi">3</span>   <span class="mi">4</span>        <span class="mi">5</span>
<span class="n">b</span> <span class="mi">1</span>     <span class="mi">6</span>   <span class="mi">7</span>        <span class="mi">8</span>
  <span class="mi">2</span>     <span class="mi">9</span>  <span class="mi">10</span>       <span class="mi">11</span>

<span class="n">frame</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">]</span>

<span class="n">frame</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">]</span>

<span class="n">frame</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> 
<span class="n">state</span>      <span class="n">Ohio</span>     <span class="n">Colorado</span>
<span class="n">color</span>     <span class="n">Green</span> <span class="n">Red</span>    <span class="n">Green</span>
<span class="n">key1</span> <span class="n">key2</span>                   
<span class="n">a</span>    <span class="mi">1</span>        <span class="mi">0</span>   <span class="mi">1</span>        <span class="mi">2</span>
     <span class="mi">2</span>        <span class="mi">3</span>   <span class="mi">4</span>        <span class="mi">5</span>
<span class="n">b</span>    <span class="mi">1</span>        <span class="mi">6</span>   <span class="mi">7</span>        <span class="mi">8</span>
     <span class="mi">2</span>        <span class="mi">9</span>  <span class="mi">10</span>       <span class="mi">11</span>

<span class="n">frame</span><span class="p">[</span><span class="s1">&#39;Ohio&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> 
<span class="n">color</span>      <span class="n">Green</span>  <span class="n">Red</span>
<span class="n">key1</span> <span class="n">key2</span>            
<span class="n">a</span>    <span class="mi">1</span>         <span class="mi">0</span>    <span class="mi">1</span>
     <span class="mi">2</span>         <span class="mi">3</span>    <span class="mi">4</span>
<span class="n">b</span>    <span class="mi">1</span>         <span class="mi">6</span>    <span class="mi">7</span>
     <span class="mi">2</span>         <span class="mi">9</span>   <span class="mi">10</span>
</pre></div>
</td></tr></table>

<ul>
<li>重新排序和排序级别</li>
</ul>
<p>以下暂略</p>
<h3 id="_24">联结和合并数据集</h3>
<ul>
<li>
<p>pandas.merge可根据键将不同DataFrame中的行连接起来。SQL或其他关系型数据库的用户对此应该会比较
熟悉，因为它实现的就是数据库的连接操作。</p>
</li>
<li>
<p>pandas.concat可以沿轴将多个对象堆叠到一起。</p>
</li>
<li>
<p>实例方法combine_first可以将重复数据编接在一起，用一个对象中的值填充另一个对象中的缺失值。</p>
</li>
</ul>
<h4 id="dataframe_1">数据库风格的DataFrame合并</h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span>
<span class="s1">&#39;data1&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)})</span>

<span class="n">df1</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">20</span><span class="p">]:</span> 
   <span class="n">data1</span> <span class="n">key</span>
<span class="mi">0</span>      <span class="mi">0</span>   <span class="n">b</span>
<span class="mi">1</span>      <span class="mi">1</span>   <span class="n">b</span>
<span class="mi">2</span>      <span class="mi">2</span>   <span class="n">a</span>
<span class="mi">3</span>      <span class="mi">3</span>   <span class="n">c</span>
<span class="mi">4</span>      <span class="mi">4</span>   <span class="n">a</span>
<span class="mi">5</span>      <span class="mi">5</span>   <span class="n">a</span>
<span class="mi">6</span>      <span class="mi">6</span>   <span class="n">b</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="s1">&#39;data2&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)})</span>

<span class="n">df2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">22</span><span class="p">]:</span> 
   <span class="n">data2</span> <span class="n">key</span>
<span class="mi">0</span>      <span class="mi">0</span>   <span class="n">a</span>
<span class="mi">1</span>      <span class="mi">1</span>   <span class="n">b</span>
<span class="mi">2</span>      <span class="mi">2</span>   <span class="n">d</span>

<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">23</span><span class="p">]:</span> 
   <span class="n">data1</span> <span class="n">key</span>  <span class="n">data2</span>
<span class="mi">0</span>      <span class="mi">0</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">1</span>      <span class="mi">1</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">2</span>      <span class="mi">6</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">3</span>      <span class="mi">2</span>   <span class="n">a</span>      <span class="mi">0</span>
<span class="mi">4</span>      <span class="mi">4</span>   <span class="n">a</span>      <span class="mi">0</span>
<span class="mi">5</span>      <span class="mi">5</span>   <span class="n">a</span>      <span class="mi">0</span>

<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">24</span><span class="p">]:</span> 
   <span class="n">data1</span> <span class="n">key</span>  <span class="n">data2</span>
<span class="mi">0</span>      <span class="mi">0</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">1</span>      <span class="mi">1</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">2</span>      <span class="mi">6</span>   <span class="n">b</span>      <span class="mi">1</span>
<span class="mi">3</span>      <span class="mi">2</span>   <span class="n">a</span>      <span class="mi">0</span>
<span class="mi">4</span>      <span class="mi">4</span>   <span class="n">a</span>      <span class="mi">0</span>
<span class="mi">5</span>      <span class="mi">5</span>   <span class="n">a</span>      <span class="mi">0</span>

<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;lkey&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span>
<span class="s1">&#39;data1&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)})</span>

<span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;rkey&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="s1">&#39;data2&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)})</span>

<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df3</span><span class="p">,</span> <span class="n">df4</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lkey&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;rkey&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">27</span><span class="p">]:</span> 
   <span class="n">data1</span> <span class="n">lkey</span>  <span class="n">data2</span> <span class="n">rkey</span>
<span class="mi">0</span>      <span class="mi">0</span>    <span class="n">b</span>      <span class="mi">1</span>    <span class="n">b</span>
<span class="mi">1</span>      <span class="mi">1</span>    <span class="n">b</span>      <span class="mi">1</span>    <span class="n">b</span>
<span class="mi">2</span>      <span class="mi">6</span>    <span class="n">b</span>      <span class="mi">1</span>    <span class="n">b</span>
<span class="mi">3</span>      <span class="mi">2</span>    <span class="n">a</span>      <span class="mi">0</span>    <span class="n">a</span>
<span class="mi">4</span>      <span class="mi">4</span>    <span class="n">a</span>      <span class="mi">0</span>    <span class="n">a</span>
<span class="mi">5</span>      <span class="mi">5</span>    <span class="n">a</span>      <span class="mi">0</span>    <span class="n">a</span>

<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">28</span><span class="p">]:</span> 
   <span class="n">data1</span> <span class="n">key</span>  <span class="n">data2</span>
<span class="mi">0</span>    <span class="mf">0.0</span>   <span class="n">b</span>    <span class="mf">1.0</span>
<span class="mi">1</span>    <span class="mf">1.0</span>   <span class="n">b</span>    <span class="mf">1.0</span>
<span class="mi">2</span>    <span class="mf">6.0</span>   <span class="n">b</span>    <span class="mf">1.0</span>
<span class="mi">3</span>    <span class="mf">2.0</span>   <span class="n">a</span>    <span class="mf">0.0</span>
<span class="mi">4</span>    <span class="mf">4.0</span>   <span class="n">a</span>    <span class="mf">0.0</span>
<span class="mi">5</span>    <span class="mf">5.0</span>   <span class="n">a</span>    <span class="mf">0.0</span>
<span class="mi">6</span>    <span class="mf">3.0</span>   <span class="n">c</span>    <span class="n">NaN</span>
<span class="mi">7</span>    <span class="n">NaN</span>   <span class="n">d</span>    <span class="mf">2.0</span>
</pre></div>
</td></tr></table>

<table>
<thead>
<tr>
<th align="center">Option</th>
<th align="center">Behavior</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">'inner'</td>
<td align="center">Use only the key combinations observed in both tables</td>
</tr>
<tr>
<td align="center">'left'</td>
<td align="center">Use all key combinations found in the left table</td>
</tr>
<tr>
<td align="center">'right'</td>
<td align="center">Use all key combinations found in the right table</td>
</tr>
<tr>
<td align="center">'output'</td>
<td align="center">Use all key combinations observed in both tables together</td>
</tr>
</tbody>
</table>
<p>上面是多对一合并，下面看下多对多</p>
<h2 id="_25">数据聚合与分组运算</h2>
<p>对数据集进行分组并对各组应用函数（无论是聚合还是转换）是数据分析工作中的重要环节。在将数据集准备好之后，通常的任务就是计算分组统计或生成透视表。</p>
<p>pandas提供了灵活高效的gruopby功能，能以自然的方式对数据集进行切片、切块、摘要等操作。关系型数据库和SQL（Structured Query Language，结构化查询语言）能够如此流行的原因之一就是其能够方便地对数据进行连接、过滤、转换和聚合。但是，像SQL这样的查询语
言所能执行的分组运算的种类很有限。</p>
<p>在本章中你将会看到，由于Python和pandas强大的表达能力，我们可以执行复杂得多的分组运算（利用任何可以接受pandas对象或NumPy数组的函数）。在本章中，你将会学到：</p>
<ul>
<li>根据一个或多个键（可以是函数、数组或DataFrame列名）拆分pandas对象。</li>
<li>计算分组摘要统计，如计数、平均值、标准差，或用户自定义函数。</li>
<li>对DataFrame的列应用各种各样的函数。</li>
<li>应用组内转换或其他运算，如规格化、线性回归、排名或选取子集等。</li>
<li>计算透视表或交叉表。</li>
<li>执行分位数分析以及其他分组分析。</li>
</ul>
<h3 id="_26">分组技术</h3>
<p>Hadley Wickham（许多热门R语言包的作者）创造了用于表示分组运算的术语"split-apply-combine"（拆分－应用－合并），我觉得这个词很好地描述了整个过程。分组运算的第一个阶段，pandas对象（无论是Series、DataFrame还是其他的）中的数据会根据你所提供的一个或多个键被拆分（split）为多组。拆分操作是在对象的特定轴上执行的。例如，DataFrame可以在其行（axis=0）或列（axis=1）上进行分组。然后，将一个函数应用（apply）到各个分组并产生一个新值。最后，所有这些函数的执行结果会被合并（combine）到最终的结果对象中。结果对象的形式一般取决于数据上所执行的操作。图9-1大致说明了一个简单的分组聚合过程。</p>
<p><img alt="捕获.PNG" src="https://bitbucket.org/repo/nxXxkM/images/905994903-%E6%8D%95%E8%8E%B7.PNG"></p>
<p>分组键可以有多种形式，且类型不必相同：
 * 列表或数组，其长度与待分组的轴一样。
 * 表示DataFrame某个列名的值。
 * 字典或Series，给出待分组轴上的值与分组名之间的对应关系。
 * 函数，用于处理轴索引或索引中的各个标签。</p>
<p>注意，后三种都只是快捷方式而已，其最终目的仍然是产生一组用于拆分对象的值。如果觉得这些东西看起来很抽象，不用担心，我将在本章中给出大量有关于此的示例。首先来看看下面这个非常简单的表格型数据集（以DataFrame的形式）。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key1&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">],</span><span class="s1">&#39;key2&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">],</span>
<span class="s1">&#39;data1&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;data2&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">)})</span>

<span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">32</span><span class="p">]:</span> 
      <span class="n">data1</span>     <span class="n">data2</span> <span class="n">key1</span> <span class="n">key2</span>
<span class="mi">0</span> <span class="o">-</span><span class="mf">0.592555</span>  <span class="mf">0.537886</span>    <span class="n">a</span>  <span class="n">one</span>
<span class="mi">1</span>  <span class="mf">0.286764</span>  <span class="mf">1.498792</span>    <span class="n">a</span>  <span class="n">two</span>
<span class="mi">2</span> <span class="o">-</span><span class="mf">0.149658</span>  <span class="mf">0.847675</span>    <span class="n">b</span>  <span class="n">one</span>
<span class="mi">3</span>  <span class="mf">0.961803</span> <span class="o">-</span><span class="mf">1.218945</span>    <span class="n">b</span>  <span class="n">two</span>
<span class="mi">4</span>  <span class="mf">0.896790</span>  <span class="mf">1.461441</span>    <span class="n">a</span>  <span class="n">one</span>
</pre></div>
</td></tr></table>

<p>假设你想要按key1进行分组，并计算data1列的平均值。实现该功能的方式有很多，而我们这里要用的是：访问data1，并根据key1调用groupby。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;data1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">])</span>

<span class="n">grouped</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">34</span><span class="p">]:</span> <span class="o">&lt;</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">groupby</span><span class="o">.</span><span class="n">SeriesGroupBy</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x000001937BF46E48</span><span class="o">&gt;</span>
</pre></div>
</td></tr></table>

<p>变量grouped是一个GroupBy对象。它实际上还没有进行任何计算，只是含有一些有关分组键df['key1']的中间数据而已。换句话说，该对象已经有了接下来对各分组执行运算所需的一切信息。例如，我们可以调用GroupBy的mean方法来计算分组平均值：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">grouped</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">35</span><span class="p">]:</span> 
<span class="n">key1</span>
<span class="n">a</span>    <span class="mf">0.197000</span>
<span class="n">b</span>    <span class="mf">0.406073</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">data1</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</td></tr></table>

<p>数据（Series）根据分组键进行了聚合，产生了新的Series，其索引为key1列中的唯一值。</p>
<p>如果我们一次传入多个数组，就会得到不同的结果：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">means</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;data1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;key2&#39;</span><span class="p">]])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">means</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">38</span><span class="p">]:</span> 
<span class="n">key1</span>  <span class="n">key2</span>
<span class="n">a</span>     <span class="n">one</span>     <span class="mf">0.152117</span>
      <span class="n">two</span>     <span class="mf">0.286764</span>
<span class="n">b</span>     <span class="n">one</span>    <span class="o">-</span><span class="mf">0.149658</span>
      <span class="n">two</span>     <span class="mf">0.961803</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">data1</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">means</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">39</span><span class="p">]:</span> 
<span class="n">key2</span>       <span class="n">one</span>       <span class="n">two</span>
<span class="n">key1</span>                    
<span class="n">a</span>     <span class="mf">0.152117</span>  <span class="mf">0.286764</span>
<span class="n">b</span>    <span class="o">-</span><span class="mf">0.149658</span>  <span class="mf">0.961803</span>

<span class="n">states</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;California&#39;</span><span class="p">,</span> <span class="s1">&#39;California&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">])</span>

<span class="n">years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">])</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;data1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">states</span><span class="p">,</span> <span class="n">years</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">42</span><span class="p">]:</span> 
<span class="n">California</span>  <span class="mi">2005</span>    <span class="mf">0.286764</span>
            <span class="mi">2006</span>   <span class="o">-</span><span class="mf">0.149658</span>
<span class="n">Ohio</span>        <span class="mi">2005</span>    <span class="mf">0.184624</span>
            <span class="mi">2006</span>    <span class="mf">0.896790</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">data1</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</td></tr></table>

<p>更常用的是列名（可以是字符串、数字或其他Python对象）用作分组键：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;key1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">44</span><span class="p">]:</span> 
         <span class="n">data1</span>     <span class="n">data2</span>
<span class="n">key1</span>                    
<span class="n">a</span>     <span class="mf">0.197000</span>  <span class="mf">1.166040</span>
<span class="n">b</span>     <span class="mf">0.406073</span> <span class="o">-</span><span class="mf">0.185635</span>

<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">45</span><span class="p">]:</span> 
              <span class="n">data1</span>     <span class="n">data2</span>
<span class="n">key1</span> <span class="n">key2</span>                    
<span class="n">a</span>    <span class="n">one</span>   <span class="mf">0.152117</span>  <span class="mf">0.999663</span>
     <span class="n">two</span>   <span class="mf">0.286764</span>  <span class="mf">1.498792</span>
<span class="n">b</span>    <span class="n">one</span>  <span class="o">-</span><span class="mf">0.149658</span>  <span class="mf">0.847675</span>
     <span class="n">two</span>   <span class="mf">0.961803</span> <span class="o">-</span><span class="mf">1.218945</span>

<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">46</span><span class="p">]:</span> 
<span class="n">key1</span>  <span class="n">key2</span>
<span class="n">a</span>     <span class="n">one</span>     <span class="mi">2</span>
      <span class="n">two</span>     <span class="mi">1</span>
<span class="n">b</span>     <span class="n">one</span>     <span class="mi">1</span>
      <span class="n">two</span>     <span class="mi">1</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</td></tr></table>

<p>你可能已经注意到在执行df.groupby('key1').mean()时，结果中没有key2列。这是因为df['key2']不是数值数据（俗称“麻烦列”），所以被从结果中排除了。默认情况下，所有数值列都会被聚合，虽然有时可能会被过滤为一个子集（稍后就会讲到）。分组键中的任何缺失值都会被排除在结果之外。</p>
<ul>
<li>分组迭代</li>
</ul>
<p>GroupBy对象支持迭代，可以产生一组二元元组（由分组名和数据块组成）。看看下面这个简单的数据集：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;key1&#39;</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>

<span class="n">a</span>
      <span class="n">data1</span>     <span class="n">data2</span> <span class="n">key1</span> <span class="n">key2</span>
<span class="mi">0</span> <span class="o">-</span><span class="mf">0.592555</span>  <span class="mf">0.537886</span>    <span class="n">a</span>  <span class="n">one</span>
<span class="mi">1</span>  <span class="mf">0.286764</span>  <span class="mf">1.498792</span>    <span class="n">a</span>  <span class="n">two</span>
<span class="mi">4</span>  <span class="mf">0.896790</span>  <span class="mf">1.461441</span>    <span class="n">a</span>  <span class="n">one</span>
<span class="n">b</span>
      <span class="n">data1</span>     <span class="n">data2</span> <span class="n">key1</span> <span class="n">key2</span>
<span class="mi">2</span> <span class="o">-</span><span class="mf">0.149658</span>  <span class="mf">0.847675</span>    <span class="n">b</span>  <span class="n">one</span>
<span class="mi">3</span>  <span class="mf">0.961803</span> <span class="o">-</span><span class="mf">1.218945</span>    <span class="n">b</span>  <span class="n">two</span>
</pre></div>
</td></tr></table>

<p>对于多重键的情况，元组的第一个元素将会是由键值组成的元组：</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://china-testing.github.io/testing_training.html">自动化性能接口测试线上及深圳培训与项目实战 qq群：144081101 591302926</a></li>
                            <li><a href="http://blog.sciencenet.cn/blog-2604609-1112306.html">pandas数据分析scrapy爬虫 521070358 Py人工智能pandas-opencv 6089740</a></li>
                            <li><a href="http://blog.sciencenet.cn/blog-2604609-1112306.html">中医解梦看相八字算命qq群 391441566 csdn书籍下载-python爬虫 437355848</a></li>
                        </ul>
                </div><!-- /.blogroll -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>